(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[5030],{31937:t=>{self,t.exports=(()=>{var t={271:function(t,e){var r,n;void 0===(n="function"==typeof(r=function(){"use strict";var t=Object.prototype.hasOwnProperty,e=Object.prototype.toString,r="boolean"==typeof(new RegExp).sticky;function n(t){return t&&"[object RegExp]"===e.call(t)}function o(t){return t&&"object"==typeof t&&!n(t)&&!Array.isArray(t)}function i(t){return"("+t+")"}function s(t){return t.length?"(?:"+t.map((function(t){return"(?:"+t+")"})).join("|")+")":"(?!)"}function a(t){if("string"==typeof t)return"(?:"+t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+")";if(n(t)){if(t.ignoreCase)throw new Error("RegExp /i flag not allowed");if(t.global)throw new Error("RegExp /g flag is implied");if(t.sticky)throw new Error("RegExp /y flag is implied");if(t.multiline)throw new Error("RegExp /m flag is implied");return t.source}throw new Error("Not a pattern: "+t)}function l(e,r){if(o(r)||(r={match:r}),r.include)throw new Error("Matching rules cannot also include states");var i={defaultType:e,lineBreaks:!!r.error||!!r.fallback,pop:!1,next:null,push:null,error:!1,fallback:!1,value:null,type:null,shouldThrow:!1};for(var s in r)t.call(r,s)&&(i[s]=r[s]);if("string"==typeof i.type&&e!==i.type)throw new Error("Type transform cannot be a string (type '"+i.type+"' for token '"+e+"')");var a=i.match;return i.match=Array.isArray(a)?a:a?[a]:[],i.match.sort((function(t,e){return n(t)&&n(e)?0:n(e)?-1:n(t)?1:e.length-t.length})),i}function c(t){return Array.isArray(t)?function(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];if(n.include)for(var o=[].concat(n.include),i=0;i<o.length;i++)e.push({include:o[i]});else{if(!n.type)throw new Error("Rule has no type: "+JSON.stringify(n));e.push(l(n.type,n))}}return e}(t):function(t){for(var e=Object.getOwnPropertyNames(t),r=[],n=0;n<e.length;n++){var i=e[n],s=t[i],a=[].concat(s);if("include"!==i){var c=[];a.forEach((function(t){o(t)?(c.length&&r.push(l(i,c)),r.push(l(i,t)),c=[]):c.push(t)})),c.length&&r.push(l(i,c))}else for(var u=0;u<a.length;u++)r.push({include:a[u]})}return r}(t)}var u=l("error",{lineBreaks:!0,shouldThrow:!0});function p(t,e){for(var o=null,l=Object.create(null),c=!0,p=null,h=[],f=[],d=0;d<t.length;d++)t[d].fallback&&(c=!1);for(d=0;d<t.length;d++){var y=t[d];if(y.include)throw new Error("Inheritance is not allowed in stateless lexers");if(y.error||y.fallback){if(o)throw!y.fallback==!o.fallback?new Error("Multiple "+(y.fallback?"fallback":"error")+" rules not allowed (for token '"+y.defaultType+"')"):new Error("fallback and error are mutually exclusive (for token '"+y.defaultType+"')");o=y}var m=y.match.slice();if(c)for(;m.length&&"string"==typeof m[0]&&1===m[0].length;)l[m.shift().charCodeAt(0)]=y;if(y.pop||y.push||y.next){if(!e)throw new Error("State-switching options are not allowed in stateless lexers (for token '"+y.defaultType+"')");if(y.fallback)throw new Error("State-switching options are not allowed on fallback tokens (for token '"+y.defaultType+"')")}if(0!==m.length){c=!1,h.push(y);for(var g=0;g<m.length;g++){var v=m[g];if(n(v))if(null===p)p=v.unicode;else if(p!==v.unicode&&!1===y.fallback)throw new Error("If one rule is /u then all must be")}var b=s(m.map(a)),w=new RegExp(b);if(w.test(""))throw new Error("RegExp matches empty string: "+w);if(new RegExp("|"+b).exec("").length-1>0)throw new Error("RegExp has capture groups: "+w+"\nUse (?: â€¦ ) instead");if(!y.lineBreaks&&w.test("\n"))throw new Error("Rule should declare lineBreaks: "+w);f.push(i(b))}}var S=o&&o.fallback,x=r&&!S?"ym":"gm",E=r||S?"":"|";return!0===p&&(x+="u"),{regexp:new RegExp(s(f)+E,x),groups:h,fast:l,error:o||u}}function h(t,e,r){var n=t&&(t.push||t.next);if(n&&!r[n])throw new Error("Missing state '"+n+"' (in token '"+t.defaultType+"' of state '"+e+"')");if(t&&t.pop&&1!=+t.pop)throw new Error("pop must be 1 (in token '"+t.defaultType+"' of state '"+e+"')")}var f=function(t,e){this.startState=e,this.states=t,this.buffer="",this.stack=[],this.reset()};f.prototype.reset=function(t,e){return this.buffer=t||"",this.index=0,this.line=e?e.line:1,this.col=e?e.col:1,this.queuedToken=e?e.queuedToken:null,this.queuedThrow=e?e.queuedThrow:null,this.setState(e?e.state:this.startState),this.stack=e&&e.stack?e.stack.slice():[],this},f.prototype.save=function(){return{line:this.line,col:this.col,state:this.state,stack:this.stack.slice(),queuedToken:this.queuedToken,queuedThrow:this.queuedThrow}},f.prototype.setState=function(t){if(t&&this.state!==t){this.state=t;var e=this.states[t];this.groups=e.groups,this.error=e.error,this.re=e.regexp,this.fast=e.fast}},f.prototype.popState=function(){this.setState(this.stack.pop())},f.prototype.pushState=function(t){this.stack.push(this.state),this.setState(t)};var d=r?function(t,e){return t.exec(e)}:function(t,e){var r=t.exec(e);return 0===r[0].length?null:r};function y(){return this.value}if(f.prototype._getGroup=function(t){for(var e=this.groups.length,r=0;r<e;r++)if(void 0!==t[r+1])return this.groups[r];throw new Error("Cannot find token type for matched text")},f.prototype.next=function(){var t=this.index;if(this.queuedGroup){var e=this._token(this.queuedGroup,this.queuedText,t);return this.queuedGroup=null,this.queuedText="",e}var r=this.buffer;if(t!==r.length){if(s=this.fast[r.charCodeAt(t)])return this._token(s,r.charAt(t),t);var n=this.re;n.lastIndex=t;var o=d(n,r),i=this.error;if(null==o)return this._token(i,r.slice(t,r.length),t);var s=this._getGroup(o),a=o[0];return i.fallback&&o.index!==t?(this.queuedGroup=s,this.queuedText=a,this._token(i,r.slice(t,o.index),t)):this._token(s,a,t)}},f.prototype._token=function(t,e,r){var n=0;if(t.lineBreaks){var o=/\n/g,i=1;if("\n"===e)n=1;else for(;o.exec(e);)n++,i=o.lastIndex}var s={type:"function"==typeof t.type&&t.type(e)||t.defaultType,value:"function"==typeof t.value?t.value(e):e,text:e,toString:y,offset:r,lineBreaks:n,line:this.line,col:this.col},a=e.length;if(this.index+=a,this.line+=n,0!==n?this.col=a-i+1:this.col+=a,t.shouldThrow)throw new Error(this.formatError(s,"invalid syntax"));return t.pop?this.popState():t.push?this.pushState(t.push):t.next&&this.setState(t.next),s},"undefined"!=typeof Symbol&&Symbol.iterator){var m=function(t){this.lexer=t};m.prototype.next=function(){var t=this.lexer.next();return{value:t,done:!t}},m.prototype[Symbol.iterator]=function(){return this},f.prototype[Symbol.iterator]=function(){return new m(this)}}return f.prototype.formatError=function(t,e){if(null==t){var r=this.buffer.slice(this.index);t={text:r,offset:this.index,lineBreaks:-1===r.indexOf("\n")?0:1,line:this.line,col:this.col}}var n=Math.max(0,t.offset-t.col+1),o=t.lineBreaks?t.text.indexOf("\n"):t.text.length,i=this.buffer.substring(n,t.offset+o);return e+=" at line "+t.line+" col "+t.col+":\n\n",(e+="  "+i+"\n")+"  "+Array(t.col).join(" ")+"^"},f.prototype.clone=function(){return new f(this.states,this.state)},f.prototype.has=function(t){return!0},{compile:function(t){var e=p(c(t));return new f({start:e},"start")},states:function(t,e){var r=t.$all?c(t.$all):[];delete t.$all;var n=Object.getOwnPropertyNames(t);e||(e=n[0]);for(var o=Object.create(null),i=0;i<n.length;i++)o[b=n[i]]=c(t[b]).concat(r);for(i=0;i<n.length;i++)for(var s=o[b=n[i]],a=Object.create(null),l=0;l<s.length;l++){var u=s[l];if(u.include){var d=[l,1];if(u.include!==b&&!a[u.include]){a[u.include]=!0;var y=o[u.include];if(!y)throw new Error("Cannot include nonexistent state '"+u.include+"' (in state '"+b+"')");for(var m=0;m<y.length;m++){var g=y[m];-1===s.indexOf(g)&&d.push(g)}}s.splice.apply(s,d),l--}}var v=Object.create(null);for(i=0;i<n.length;i++){var b;v[b=n[i]]=p(o[b],!0)}for(i=0;i<n.length;i++){var w=n[i],S=v[w],x=S.groups;for(l=0;l<x.length;l++)h(x[l],w,v);var E=Object.getOwnPropertyNames(S.fast);for(l=0;l<E.length;l++)h(S.fast[E[l]],w,v)}return new f(v,e)},error:Object.freeze({error:!0}),fallback:Object.freeze({fallback:!0}),keywords:function(t){for(var e=Object.create(null),r=Object.create(null),n=Object.getOwnPropertyNames(t),o=0;o<n.length;o++){var i=n[o],s=t[i];(Array.isArray(s)?s:[s]).forEach((function(t){if((r[t.length]=r[t.length]||[]).push(t),"string"!=typeof t)throw new Error("keyword must be string (in keyword '"+i+"')");e[t]=i}))}function a(t){return JSON.stringify(t)}var l="";for(var c in l+="switch (value.length) {\n",r){var u=r[c];l+="case "+c+":\n",l+="switch (value) {\n",u.forEach((function(t){var r=e[t];l+="case "+a(t)+": return "+a(r)+"\n"})),l+="}\n"}return l+="}\n",Function("value",l)}}})?r.apply(e,[]):r)||(t.exports=n)}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n].call(i.exports,i,i.exports,r),i.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};return(()=>{"use strict";r.r(n),r.d(n,{default:()=>Tt});var t=r(271),e=r.n(t);function o(t){return d(t)||c(t)||h(t)||p()}function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function s(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){a(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function l(t){return function(t){if(Array.isArray(t))return f(t)}(t)||c(t)||h(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function u(t,e){return d(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],s=!0,a=!1;try{for(r=r.call(t);!(s=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);s=!0);}catch(t){a=!0,o=t}finally{try{s||null==r.return||r.return()}finally{if(a)throw o}}return i}}(t,e)||h(t,e)||p()}function p(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(t,e){if(t){if("string"==typeof t)return f(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function d(t){if(Array.isArray(t))return t}var y="(?:\r|\t|\f|\n| ){0,}",m="(?:\r|\t|\f|\n| ){1,}",g="[0-9]",v="}".concat(y,";"),b="".concat(g,"{1,}"),w="".concat(g,"{1,}(?:\\.").concat(g,"{0,}|)(?:k|M|G|)"),S="\\[".concat(y,"(?:@scale|@sd)").concat(y,"(?:>=|>)").concat(y).concat(w).concat(y,"\\]"),x="\\[".concat(y,"(?:@scale|@sd)").concat(y,"(?:<=|<)").concat(y).concat(w).concat(y,"\\]"),E="(?:-|)[_a-zA-Z]".concat("[\\-\\_a-zA-Z0-9]","{0,}"),O="#".concat(E,"(?:\\:").concat(E,"|)(?:\\.[^\\\"|\\'|\\[|\\]|\\r|\\t|\\f|\\n| ]{1,}|)"),F="mark|stroke|fill|symbol|shield|background",C=":(?:".concat(F,")"),k=":nth\\-(?:".concat(F,")\\(").concat(b,"\\)"),P="".concat(E,"(?:\\:").concat(E,"|)"),D=P,T="\\'[^\\\"|\\'|\\[|\\]]{0,}\\'",I="\\[(?:".concat(T,"|").concat('\\"[^\\"|\\\'|\\[|\\]]{0,}\\"',"|[^\\\"|\\'|\\[|\\]]{0,}){1,}\\]"),N="(?:".concat("\\/\\*[^\\*\\/]*?\\*\\/","|").concat(m,"){0,}"),_="(?:\\*|"+S+"|"+x+"|"+O+"|"+C+"|"+k+"|"+D+"|"+I+")",j="".concat(_,"(?:").concat(y).concat(_,"|").concat(y).concat("\\,").concat(y).concat(_,"){0,}"),z="[a-zA-Z0-9-\\._\\]\\:\\/\\?\\#\\[\\]\\@\\|\\$\\&'\\*\\+\\,\\;\\=]{1,}",M="(?:"+"\\'".concat(z,"\\'")+"|"+z+")",R="url".concat(y,"\\(").concat(y).concat(M).concat(y,"\\)"),A="symbol".concat(y,"\\(").concat(y).concat(M).concat(y,"\\)"),L="[a-fA-F0-9]",G="#(?:".concat(L).concat(L).concat(L).concat(L).concat(L).concat(L,"|").concat(L).concat(L).concat(L,")"),B="".concat(g,"{1,}(?:\\.").concat(g,"{0,}|)(?:k|M|G|px|m|ft|%|deg|)"),V="\\[".concat(y,"[^\\[;]*?").concat(y,"\\]"),$="@".concat(E),q="(?:none|"+G+"|"+B+"|\\'.*?\\'|"+$+")",K="(?:none|"+"".concat(P).concat(y,"\\(").concat(y).concat(q,"(?:").concat(y,",").concat(y).concat(q).concat(y,"){0,}").concat(y,"\\)")+"|"+G+"|"+B+"|\\'.*?\\'|"+$+")",W="".concat(P).concat(y,"\\(").concat(y).concat(K,"(?:").concat(y,",").concat(y).concat(K).concat(y,"){0,}").concat(y,"\\)"),U="\\'[^;\\'\\[\\]]*?\\'",Y="(?:".concat(V,"|").concat(U,"){1,}"),X="(?:none|"+R+"|"+A+"|"+W+"|"+G+"|"+B+"|"+E+"|"+$+"|"+Y+"|"+V+")",H="".concat(X,"(?:").concat(m).concat(X,"){1,}"),Z="(?:"+X+"|"+H+")",J=""+N+E+"(?:\r|\t|\f|\n| ){0,}:"+y+Z+"(?:\r|\t|\f|\n| ){0,}(?:,"+y+Z+"){0,};",Q="@(?:mode|styleTitle|styleAbstract)".concat(m).concat(T,";"),tt="".concat(m,"(?:in|IN|not in|NOT IN|is|IS|like|ilike|LIKE|ILIKE|\\=|\\>|\\>\\=|\\<|\\<\\=|\\<\\>)").concat(m);function et(t){if(t.match(/'/g))return t.replace(new RegExp("\\'([^\\\"|\\'|\\[|\\]]{0,})\\'","g"),"$1");var e=parseFloat(t);if(!isNaN(e))return e;var r=t.trim();return"true"===r||"false"===r?["bool",r]:r}function rt(t,e){if(t.match(new RegExp(H))){var r=t.match(new RegExp(X,"g"));return["array"].concat(l(r.map((function(t){return rt(t)}))))}if(t.match(new RegExp(R)))return["url",t.replace(new RegExp("url".concat(y,"\\(").concat(y,"(").concat(M,")").concat(y,"\\)"),"g"),"$1").replace(/'(.*?)'/g,"$1")];if(t.match(new RegExp(A)))return["symbol",t.replace(new RegExp("symbol".concat(y,"\\(").concat(y,"(").concat(M,")").concat(y,"\\)"),"g"),"$1").replace(/'(.*?)'/g,"$1")];if(t.match(new RegExp(V))&&"label"!==e){var n,o=t.replace(new RegExp("\\[".concat(y,"([^\\[;]*?)").concat(y,"\\]"),"g"),"$1"),i=null===(n=o.match(new RegExp("".concat(Z,"(?:").concat(m,"(\\*|\\/|\\+|\\-)").concat(m).concat(Z,"){0,}"))))||void 0===n?void 0:n[1],s=o.match(new RegExp(Z,"g"));return i?["brace",[i,rt(null==s?void 0:s[0]),rt(null==s?void 0:s[1])]]:["brace",rt(s[0])]}if(t.match(new RegExp(W))){var a,c=null===(a=t.match(P))||void 0===a?void 0:a[0],u=t.replace(c,"").match(new RegExp(K,"g"));return[c].concat(l(u.map((function(t){return rt(t)}))))}if(t.match(new RegExp(Y))){var p=t.match(new RegExp("".concat(V,"|").concat(U),"g")).map((function(t){return t.match(new RegExp(U))&&!t.match(new RegExp(V))?t.replace(/'([^;'[\]]*?)'/,"$1"):rt(t)}));return 1===p.length?p[0]:["text"].concat(l(p))}if(t.match(new RegExp(G)))return["hex",t];if(t.match(new RegExp(B))){var h,f=parseFloat(t.replace(/k|M|G|px|m|ft|%|deg/g,"")),d=null===(h=t.match(/(?:k|M|G|px|m|ft|%|deg)/g))||void 0===h?void 0:h[0];return d?["measure",f,d]:f}return t.match(new RegExp(E))?["get",t]:t}var nt=e().compile({directive:{match:new RegExp(Q),value:function(t){return{key:t.match(/@(:?mode|styleTitle|styleAbstract)/)[0],value:t.match(/'.*?'/)[0].replace(/'(.*?)'/g,"$1")}}},whitespace:{match:new RegExp(m),lineBreaks:!0,value:function(t){return{value:t}}},property:{match:new RegExp(J),value:function(t){var e=t.match(new RegExp(N))[0].trim(),r=t.match(new RegExp(E+y+":"))[0].replace(/:/,"").trim(),n=t.replace(new RegExp(N),"").replace(new RegExp(E+y+":"),"").match(new RegExp("".concat(X,"(?:").concat(m).concat(X,"){0,}"),"g")).map((function(t){return rt(t,r)}));return{comment:e,key:r,value:n}}},openBrace:{match:new RegExp("{"),value:function(t){return{value:t}}},closeBraceSemicolon:{match:new RegExp(v),value:function(t){return{value:t}}},closeBrace:{match:new RegExp("}"),value:function(t){return{value:t}}},selector:{match:new RegExp(N+j),value:function(t){var e,r,n,o,i,s,a=t.match(new RegExp(N))[0].trim(),c=null==a||null===(e=a.match(new RegExp("@title".concat(y,"(\\:){0,1}").concat(y,".*?\\*\\/"))))||void 0===e||null===(r=e[0])||void 0===r||null===(n=r.replace(new RegExp("@title".concat(y,"(\\:){0,1}|\\*\\/"),"g"),""))||void 0===n?void 0:n.trim(),p=null==a||null===(o=a.match(new RegExp("@source".concat(y,"(\\:){0,1}").concat(y,".*?\\*\\/"))))||void 0===o||null===(i=o[0])||void 0===i||null===(s=i.replace(new RegExp("@source".concat(y,"(\\:){0,1}|\\*\\/"),"g"),""))||void 0===s?void 0:s.trim(),h=t.replace(new RegExp(N),"").split(new RegExp("\\]".concat(y,",").concat(y,"\\["),"g"));return{source:p,title:c,comment:a,value:h.map((function(t,e){return 0===e?t+"]":e===h.length-1?"["+t:"["+t+"]"})).map((function(t){return t.match(new RegExp(_,"g")).map((function(t){return function(t){if(t.match(new RegExp("\\*"))&&!t.match(new RegExp(I)))return{value:t,type:"allSelector"};if(t.match(new RegExp(S))){var e,r,n=null===(e=t.match(/>=|>/g))||void 0===e?void 0:e[0],o=u(t.replace(/\[|\]/g,"").split(new RegExp("".concat(y,"(?:>=|>)").concat(y))),2),i=o[0],s=o[1],a=parseFloat(s.replace(/k|M|G/g,"")),c=null===(r=s.match(/(?:k|M|G)/g))||void 0===r?void 0:r[0];return{value:t,type:"minScaleSelector",expression:[n,["get",i],c?["measure",a,c]:a]}}if(t.match(new RegExp(x))){var p,h,f=null===(p=t.match(/<=|</g))||void 0===p?void 0:p[0],d=u(t.replace(/\[|\]/g,"").split(new RegExp("".concat(y,"(?:<=|<)").concat(y))),2),g=d[0],v=d[1],b=parseFloat(v.replace(/k|M|G/g,"")),w=null===(h=v.match(/(?:k|M|G)/g))||void 0===h?void 0:h[0];return{value:t,type:"maxScaleSelector",expression:[f,["get",g],w?["measure",b,w]:b]}}if(t.match(new RegExp(O)))return{value:t,type:"idSelector"};if(t.match(new RegExp(C)))return{value:t,type:"pseudoClassSelector"};if(t.match(new RegExp(k)))return{value:t,type:"numberedPseudoClassSelector"};if(t.match(new RegExp(I))){var E={"=":"==",">":">",">=":">=","<":"<","<=":"<=","<>":"!=",like:"like",ilike:"ilike",LIKE:"like",ILIKE:"ilike"},F="".concat(m,"(?:or|OR)").concat(m),P="".concat(m,"(?:and|AND)").concat(m),T=t.match(new RegExp(F,"g"))&&"any",N=t.match(new RegExp(P,"g"))&&"all";if(T&&N)throw new Error("or and operators");var _=T?F:P,j=t.replace(/\[|\]/g,"").split(new RegExp(_,"g")).map((function(e){var r,n,o,i=new RegExp(tt),s=null===(r=e.match(i))||void 0===r||null===(n=r[0])||void 0===n||null===(o=n.trim)||void 0===o?void 0:o.call(n),a=e.split(new RegExp(tt));if(E[s])return[E[s],["get",a[0]],et(a[1])];if(!("is"!==s&&"IS"!==s||"null"!==a[1]&&"NULL"!==a[1]))return["isnull",["get",a[0]]];if("in"===s||"not in"===s||"IN"===s||"NOT IN"===s){var l=a[1].replace(/\(|\)/g,"").split(",").map((function(t){return et(t.trim())})),c=["in",["get",a[0]],["literal",l]];return"not in"===s||"NOT IN"===s?["!",c]:c}throw new Error("\n                operator not supported in selector: ".concat(t,"\n                supported operators: ").concat(Object.keys(E).join(" ")))}));return{value:t,expression:j.length>1?[T||N].concat(l(j)):j[0],type:"eCQLSelector"}}return t.match(new RegExp(D))?{value:t,type:"typeNameSelector"}:{value:t,type:"basicSelector"}}(t)}))}))}}}});function ot(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return function(t){return e.reduce((function(t,e){return e(t)}),t)}}function it(t){return nt.reset(t),Array.from(nt)}function st(t){return t.map((function(t){var e=t.type,r=t.value,n=t.line,o=t.col,i=t.text;return s(s({},r),{},{type:e,line:n,col:o,text:i})}))}var at=["typeNameSelector"];function lt(t){var e=["pseudoClassSelector","numberedPseudoClassSelector","allSelector","typeNameSelector"];return t.filter((function(t){return"selector"===t.type})).forEach((function(t){var r=t.value,n=t.line,o=t.col,i=t.text,s=t.level,a=r.map((function(t){return t.map((function(t){return t.type}))})).reduce((function(t,e){return[].concat(l(t),l(e))}));if(a.length>1&&a.find((function(t){return-1!==e.indexOf(t)})))throw{line:n,col:o,text:i};if(1===a.length&&-1!==at.indexOf(a[0])&&1!==s)throw{line:n,col:o,text:i}})),t}function ct(t){var e=0,r=0,n=0,o=0;return t.filter((function(t){var e=t.type;return"whitespace"!==e&&"directive"!==e})).map((function(t){r=e;var i=(t||{}).type;"openBrace"===i&&(e++,o++),"closeBrace"!==i&&"closeBraceSemicolon"!==i||e--;var a="selector"===i||"closeBrace"===i||"closeBraceSemicolon"===i?e+1:e,l=n;return 1===r&&1===a&&"closeBrace"===i&&(n++,o=0,l=n-1),s(s(s({},t),"selector"===i&&{rule:o}),{},{level:a,group:l})}))}function ut(t){var e=t.reduce((function(t,e){var r="".concat(e.group,":").concat(e.level);return s(s({},t),{},a({},r,t[r]?[].concat(l(t[r]),[e]):[e]))}),{});return Object.keys(e).map((function(t){return e[t].reduce((function(t,e){if(t.length>0){var r=t.filter((function(e,r){return r<t.length-1})),n=[].concat(l(t[t.length-1]),[e]);return[].concat(l(r),[n],l("closeBrace"===e.type||"closeBraceSemicolon"===e.type?[[]]:[]))}return[[e]]}),[])}))}function pt(t){return t.reduce((function(t,e){return[].concat(l(t),l(e.filter((function(t){return t.length>0})).map((function(t){return t.map((function(e){return s(s({},e),{},{rule:t[0].rule})}))}))))}),[])}function ht(t){return l(t).sort((function(t,e){return t[0].group===e[0].group?t[0].rule>e[0].rule?1:-1:t[0].group>e[0].group?1:-1}))}function ft(t){return t.map((function(t){var e=t.find((function(t){return"selector"===t.type}))||{},r=e.title,n=e.value,o=e.level,i=e.group,l=e.rule,c=t.filter((function(t){return"property"===t.type})).reduce((function(t,e){return s(s({},t),{},a({},e.key,e.value))}),{});return s(s({},r&&{title:r}),{},{selector:n,properties:c,level:o,group:i,rule:l})}))}function dt(t){return t.map((function(e,r){var n=e.level,o=e.group;if(1===n)return e;var i=[].concat(l(t.filter((function(t,e){return e<r&&t.group===o&&t.level<n}))),[e]);return 1===i.length?e:s(s({},e),{},{activeRules:i})}))}function yt(t){return t&&1===t.length&&1===t[0].length&&t[0][0]||{}}function mt(t){var e=t.reduce((function(t,e){var r=e.level,n=e.group,o=e.rule,i=e.activeRules,l=e.selector,c=e.properties;if(!i)return t;if("pseudoClassSelector"===yt(l).type||"numberedPseudoClassSelector"===yt(l).type){var u,p=i[i.length-2],h=p.level,f=p.group,d=p.rule;return s(s({},t),{},(a(u={},"".concat(r,":").concat(n,":").concat(o),"remove"),a(u,"".concat(h,":").concat(f,":").concat(d),s(s({},t["".concat(h,":").concat(f,":").concat(d)]),{},a({},l[0][0].value,c))),u))}return t}),{});return t.filter((function(t){var r=t.level,n=t.group,o=t.rule;return"remove"!==e["".concat(r,":").concat(n,":").concat(o)]})).map((function(t){var r=t.level,n=t.group,o=t.properties,i=t.rule;return e["".concat(r,":").concat(n,":").concat(i)]?s(s({},t),{},{properties:s(s({},o),e["".concat(r,":").concat(n,":").concat(i)])}):t}))}function gt(t){return t.map((function(t){var e=t.activeRules;if(!e)return t;var r=(e.find((function(t){return"typeNameSelector"===yt(t.selector).type}))||{}).selector,n=yt(r).value;return s(s({},t),{},{layer:n,activeRules:e.filter((function(t){return"typeNameSelector"!==yt(t.selector).type}))})}))}function vt(t){return t.map((function(t){var e=t.activeRules,r=t.layer;if(!e){var n=t.selector,o=t.properties,i=t.title;return s(s(s({},i&&{title:i}),r&&{layer:r}),{},{selector:n,properties:o})}var a=e.map((function(t){return t.selector})).reduce((function(t,e){var r=[];return t.forEach((function(t){e.forEach((function(e){r.push([].concat(l(t),l(e)))}))})),r})),c=e.map((function(t){return t.properties})).reduce((function(t,e){return s(s({},t),e)})),u=e.map((function(t){return t.title})).reduce((function(t,e){return[].concat(l(t),l(e&&[e]||[]))}),[]).join(", ");return s(s(s({},u&&{title:u}),r&&{layer:r}),{},{selector:a,properties:c})}))}function bt(t){return t.reduce((function(t,e){var r=function(t){return t.reduce((function(t,e,r){var n,o,i=e.filter((function(t){return"minScaleSelector"===t.type})),c=e.filter((function(t){return"maxScaleSelector"===t.type})),u=[i[i.length-1],c[c.length-1]],p="".concat((null==u||null===(n=u[0])||void 0===n?void 0:n.value)||"").concat((null==u||null===(o=u[1])||void 0===o?void 0:o.value)||"")||"noScale";return t[p]?s(s({},t),{},a({},p,{selectorIndex:[].concat(l(t[p].selectorIndex),[r]),scales:u})):s(s({},t),{},a({},p,{selectorIndex:[r],scales:u}))}),{})}(e.selector),n=e.selector.map((function(t){return t.filter((function(t){var e=t.type;return!("minScaleSelector"===e||"maxScaleSelector"===e)}))})),o=n.map((function(t){return t.map((function(t){return t.type}))})).reduce((function(t,e){return[].concat(l(t),l(e))}));return[].concat(l(t),l(Object.keys(r).map((function(t){var i,a,c=r[t],u=c.selectorIndex,p=void 0===u?[]:u,h=c.scales,f=null===(i=h[0])||void 0===i?void 0:i.expression,d=null===(a=h[1])||void 0===a?void 0:a.expression,y=1===o.length&&"allSelector"===o[0];return s(s(s({},e),{},{selector:y?"*":["any"].concat(l(n.filter((function(t,e){return-1!==p.indexOf(e)})).map((function(t){return["all"].concat(l(t.map((function(t){return null==t?void 0:t.expression}))))}))))},f&&{"min-scale":f}),d&&{"max-scale":d})}))))}),[])}function wt(t){return t.filter((function(t){var e=t.properties;return Object.keys(e).length>0}))}function St(t,e){return Object.keys(t).reduce((function(r,n){return s(s({},r),{},a({},n,void 0===t[n][e]?t[n][0]:t[n][e]))}),{})}function xt(t){var e=0;return t.reduce((function(t,r){e++;var n=Object.keys(null==r?void 0:r.properties),o=Math.max.apply(null,n.filter((function(t){return!t.match(new RegExp("(?:".concat(C,"|").concat(k,")")))})).map((function(t){var e,n;return null==r||null===(e=r.properties)||void 0===e||null===(n=e[t])||void 0===n?void 0:n.length})).filter((function(t){return t}))),i=Object.keys(l(new Array(o))).map((function(t){return n.reduce((function(e,n){var o,i;if(n.match(new RegExp(C)))return s(s({},e),{},a({},n,St(null==r||null===(i=r.properties)||void 0===i?void 0:i[n],t)));if(n.match(new RegExp(k))){var l,c=n.match(new RegExp(":nth\\-((?:".concat(F,"))\\((").concat(b,")\\)"))),u=null==c?void 0:c[1],p=null==c?void 0:c[2];return s(s({},e),void 0!==p&&parseFloat(p)-1+""===t&&a({},":".concat(u),St(null==r||null===(l=r.properties)||void 0===l?void 0:l[n],t)))}var h=null!==(o=null==r?void 0:r.properties[n][t])&&void 0!==o?o:null==r?void 0:r.properties[n][0];return s(s({},e),null!=h&&a({},n,h))}),{})}));return[].concat(l(t),l(i.map((function(t){return s(s({},r),{},{properties:t,group:e})}))))}),[])}function Et(t,e){if(void 0!==t){if("string"==typeof t||t instanceof String)return"'".concat(t,"'");if(!isNaN(t))return t;var r=o(t),n=r[0],i=r.slice(1);switch(n){case"+":case"-":case"*":case"/":return"".concat(Et(i[0])," ").concat(n," ").concat(Et(i[1]));case"any":return i.map((function(t){return Et(t)})).join(" or ");case"all":return i.map((function(t){return Et(t)})).join(" and ");case"isnull":return Et(i[0])+" is null";case">":case"<":case">=":case"<=":case"!=":case"==":case"like":case"ilike":return Et(i[0])+" "+{"==":"=",">":">",">=":">=","<":"<","<=":"<=","!=":"<>",like:"like",ilike:"ilike",LIKE:"like",ILIKE:"ilike"}[n]+" "+Et(i[1]);case"!":return Et(i[0],{prefix:"not "});case"in":return Et(i[0])+" "+((null==e?void 0:e.prefix)||"")+"in ("+i.filter((function(t,e){return e>0})).map((function(t){return Et(t)})).join("")+")";case"bool":case"get":case"hex":return i[0];case"literal":return i[0].map((function(t){return Et(t)})).join(", ");case"measure":return"".concat(i[0]).concat(i[1]||"");case"recode":case"categorize":case"interpolate":case"color-map-entry":case"env":return"".concat(n,"(").concat(i.map((function(t){return Et(t)})).join(", "),")");case"url":case"symbol":return"".concat(n,"('").concat(i[0],"')");case"brace":return"[".concat(i.map((function(t){return Et(t)})),"]");case"array":return i.map((function(t){return Et(t)})).join(" ");case"text":return i.map((function(t){return Et(t)})).join("");default:return t}}}function Ot(t){for(var e=[],r=0;r<t.length;r++){var n=t[r],o=e[e.length-1]||{},i=o.group;void 0!==i&&i===n.group?e[e.length-1]=s(s({},o),{},{properties:[].concat(l(Array.isArray(o.properties)?o.properties:[o.properties]),[n.properties])}):e.push(n)}return e}function Ft(t,e){if(e){var r=Array.isArray(t)?t:[t];return Object.keys(r[0]).reduce((function(t,e){return s(s({},t),{},a({},e,Ft(r.map((function(t){return t[e]})))))}),{})}var n=t.filter((function(t){return null!=t}));return 1===n.length||n.every((function(t,e,r){return t===r[0]}))?n[0]:n.join(", ")}function Ct(t){return(t||[]).map((function(t){var e=(null==t?void 0:t["min-scale"])&&Et(t["min-scale"]),r=(null==t?void 0:t["max-scale"])&&Et(t["max-scale"]),n=Array.isArray(t.properties)?t.properties:[t.properties],i=Object.keys(n[0]),c=function(t){if("*"===t)return"*";var e=o(t),r=e[0],n=e.slice(1);if("any"!==r&&"all"!==r)return["any",["all",t]];if("all"===r)return["any",t];if("any"===r){var i=n.map((function(t){return"all"!==t[0]?["all",t]:t}));return["any"].concat(l(i))}return"*"}(t.selector);return s(s(s({},(null==t?void 0:t.title)&&{title:"/* @title ".concat(t.title," */")}),(null==t?void 0:t.layer)&&{layer:t.layer}),{},{selector:"any"===(null==c?void 0:c[0])?c.filter((function(t,e){return e>0})).map((function(t){return[].concat(l(t.filter((function(t,e){return e>0})).map((function(t){return"["+Et(t)+"]"}))),l(e&&["["+e+"]"]||[]),l(r&&["["+r+"]"]||[]))})):c,properties:i.reduce((function(t,e){return e.match(new RegExp("(?:".concat(C,"|").concat(k,")")))?s(s({},t),{},a({},e,Ft(n.map((function(t){return Object.keys(t[e]).reduce((function(r,n){return s(s({},r),{},a({},n,Et(t[e][n])))}),{})})),!0))):s(s({},t),{},a({},e,Ft(n.map((function(t){return Et(t[e])})))))}),{})})}))}function kt(t){return t.map((function(t){return t.layer})).reduce((function(e,r,n){var o;if(void 0===r)return[].concat(l(e),[t[n]]);var i=null===(o=e[e.length-1])||void 0===o?void 0:o.layer;return void 0!==i&&i===r?[].concat(l(e.filter((function(t,r){return r<e.length-1}))),[{layer:r,rules:[].concat(l(e[e.length-1].rules),[t[n]])}]):[].concat(l(e),[{layer:r,rules:[t[n]]}])}),[])}function Pt(t,e){var r=(null==e?void 0:e.baseTab)||"",n=(null==e?void 0:e.tab)||"  ",o=(null==t?void 0:t.title)&&(null==t?void 0:t.title)+"\n"||"",i=(null==t?void 0:t.selector)?"*"===t.selector?"*":t.selector.map((function(t){return r+t.join("\n")})).join(",\n"):"",s=Object.keys(null==t?void 0:t.properties).reduce((function(e,o){if(o.match(new RegExp("(?:".concat(C,"|").concat(k,")")))){var i=Object.keys(t.properties[o]).reduce((function(e,i){return e+r+n+n+i+": "+t.properties[o][i]+";\n"}),"");return e+r+n+o+" {\n"+i+r+n+"};\n"}return e+r+n+o+": "+t.properties[o]+";\n"}),"");return r+o+i+" {\n"+s+r+"}\n"}function Dt(t){var e="  ";return t.reduce((function(t,r){return r.layer&&r.rules?t+r.layer+" {\n"+r.rules.map((function(t){return Pt(t,{tab:e,baseTab:e})})).join("")+"}\n":t+Pt(r,{tab:e})}),"")}const Tt={read:function(t){var e=ot(it,st)(t);return{directive:e.filter((function(t){return"directive"===t.type})).reduce((function(t,e){var r=e.key,n=e.value;return s(s({},t),{},a({},r,n))}),{}),rules:ot(ct,lt,ut,pt,ht,ft,dt,mt,gt,vt,bt,wt,xt)(e)}},write:function(t){return Object.keys(null==t?void 0:t.directive).reduce((function(e,r){return e+r+" '"+t.directive[r]+"';\n"}),"")+"\n"+ot(Ot,Ct,kt,Dt)(null==t?void 0:t.rules)}}})(),n})()},50436:function(t,e,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)},o=this&&this.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r},i=this&&this.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n};Object.defineProperty(e,"__esModule",{value:!0}),e.GeoCSSStyleParser=void 0;var s=r(31937).default,a=r(84596),l=r(1469),c=r(14293),u=r(81763),p=r(18446),h=r(85564),f=r(47037),d=r(13311),y=function(){function t(){this.title="GeoCSS Style Parser",this.warnings=[],this.getFisrtValidPesudoselector=function(t,e){return(d(e,(function(e){return!c(e[t])}))||{})[t]||{}}}return t.prototype.addWarning=function(t){this.warnings.push(t)},t.prototype.getWarnings=function(){return i(this.warnings)},t.prototype.readExpression=function(t){if(void 0===t)return null;if("string"==typeof t||t instanceof String)return t;if(!isNaN(t))return t;var e=t[0],r=t.slice(1);switch(e){case"array":return r;case"get":case"hex":case"symbol":case"url":return r[0];case"bool":return"true"===r[0];default:return t}},t.prototype.readSelectorsExpression=function(e){var r=this;if(e){var n=e[0],o=e.slice(1);switch(n){case"any":case"all":var s=t.combinationMap[n];return i([s],o.map((function(t){return r.readSelectorsExpression(t)})));case">":case"<":case">=":case"<=":case"!=":case"==":case"like":case"ilike":return[t.comparisonMap[n],this.readExpression(o[0]),this.readExpression(o[1])];case"isnull":return["==",this.readExpression(o[0]),null];default:return}}},t.prototype.getFilterFromSelectors=function(t){var e=this.readSelectorsExpression(t);if(e)return"||"!==e[0]&&"&&"!==e[0]||2!==e.length?e:e[1]},t.prototype.getScaleDenominatorFromSelectors=function(t){var e=t&&this.readExpression(t["min-scale"]),r=t&&this.readExpression(t["max-scale"]),o=!c(e)&&{min:e[2]},i=!c(r)&&{max:r[2]};return o||i?n(n({},o),i):void 0},t.prototype.getMarkSymbolizerFromGeoCSSRule=function(t){var e,r=this.readExpression(t.mark);switch(r){case"circle":case"square":case"triangle":case"star":case"cross":case"x":e=r.charAt(0).toUpperCase()+r.slice(1);break;case"shape://vertline":case"shape://horline":case"shape://slash":case"shape://backslash":case"shape://dot":case"shape://plus":case"shape://times":case"shape://oarrow":case"shape://carrow":e=r;break;default:throw new Error("MarkSymbolizer cannot be parsed. Unsupported WellKnownName.")}var o=this.readExpression(t["mark-size"]),i=this.readExpression(t["mark-rotation"]),s=this.readExpression(t["mark-opacity"]),a=t[":mark"]||{},l=s,u=this.readExpression(a["fill-opacity"]),p=this.readExpression(a.fill),h=this.readExpression(a.rotation)||i,f=this.readExpression(a.size)||o,d=this.readExpression(a.stroke),y=this.readExpression(a["stroke-width"]),m=this.readExpression(a["stroke-opacity"]),g=e&&{wellKnownName:e},v=!c(l)&&{opacity:l},b=!c(u)&&{fillOpacity:u},w=p&&{color:p},S=!c(h)&&{rotate:h},x=!c(f)&&{radius:f/2},E=d&&{strokeColor:d},O=!c(y)&&{strokeWidth:y},F=!c(m)&&{strokeOpacity:m};return n(n(n(n(n(n(n(n(n({kind:"Mark"},g),v),b),w),S),x),E),O),F)},t.prototype.getIconSymbolizerFromGeoCSSRule=function(t){var e=this.readExpression(t.mark),r=this.readExpression(t["mark-size"]),o=this.readExpression(t["mark-rotation"]),i=this.readExpression(t["mark-opacity"]),s=e&&{image:e},a=!c(i)&&{opacity:i},l=!c(o)&&{rotate:o},u=!c(r)&&{size:r};return n(n(n(n({kind:"Icon"},s),a),l),u)},t.prototype.getPointSymbolizerFromGeoCSSRule=function(t){return"url"===t.mark[0]?this.getIconSymbolizerFromGeoCSSRule(t):this.getMarkSymbolizerFromGeoCSSRule(t)},t.prototype.getLineSymbolizerFromGeoCSSRule=function(t){var e=this.readExpression(t.stroke),r=this.readExpression(t["stroke-width"]),o=this.readExpression(t["stroke-opacity"]),i=this.readExpression(t["stroke-linejoin"]),s=this.readExpression(t["stroke-linecap"]),a=this.readExpression(t["stroke-dasharray"]),l=this.readExpression(t["stroke-dashoffset"]),u=this.readExpression(t["stroke-offset"]),p="symbol"===t.stroke[0]||"url"===t.stroke[0]?this.getPointSymbolizerFromGeoCSSRule({mark:t.stroke,"mark-size":t["stroke-size"],"mark-rotation":t["stroke-rotation"],":mark":t[":stroke"]}):void 0,h=!p&&e&&{color:e},f=p&&{graphicStroke:p},d=!c(r)&&{width:r},y=!c(o)&&{opacity:o},m=i&&{join:i},g=s&&{cap:s},v=a&&{dasharray:a},b=l&&{dashOffset:l},w=!c(u)&&{perpendicularOffset:u};return n(n(n(n(n(n(n(n(n({kind:"Line"},h),f),d),y),m),g),v),b),w)},t.prototype.getFillSymbolizerFromGeoCSSRule=function(t){var e=this.readExpression(t.fill),r=this.readExpression(t["fill-opacity"]),o=this.readExpression(t.stroke),i=this.readExpression(t["stroke-width"]),s=this.readExpression(t["stroke-opacity"]),a=this.readExpression(t["stroke-dasharray"]),l="symbol"===t.fill[0]||"url"===t.fill[0]?this.getPointSymbolizerFromGeoCSSRule({mark:t.fill,"mark-size":t["fill-size"],"mark-rotation":t["fill-rotation"],":mark":t[":fill"]}):void 0,u=!l&&e&&{color:e},p=l&&{graphicFill:l},h=!e&&{opacity:0},f=!c(r)&&{fillOpacity:r},d=o&&{outlineColor:o},y=!c(i)&&{outlineWidth:i},m=!c(s)&&{outlineOpacity:s},g=a&&{outlineDasharray:a};return n(n(n(n(n(n(n(n({kind:"Fill"},u),p),h),f),d),y),m),g)},t.prototype.getTextSymbolizerLabelFromGeoCSSProperty=function(t){var e=function t(e){if(void 0===e)return null;if("string"==typeof e||e instanceof String)return e;if(!isNaN(e))return e;var r=e[0],n=e.slice(1);switch(r){case"text":return n.map((function(e){return t(e)}));case"brace":return t(n[0]);case"get":return"{{"+n[0]+"}}";default:return e}}(t);return l(e)?e.join(""):e},t.prototype.getTextSymbolizerFromGeoCSSRule=function(t){var e=this.getTextSymbolizerLabelFromGeoCSSProperty(t.label),r=this.readExpression(t["font-fill"]),o=this.readExpression(t["halo-radius"]),i=this.readExpression(t["halo-color"]),s=this.readExpression(t["label-offset"]),l=this.readExpression(t["label-rotation"]),u=this.readExpression(t["font-family"]),p=this.readExpression(t["font-style"]),h=this.readExpression(t["font-weight"]),f=this.readExpression(t["font-size"]),d=e&&{label:e},y=r&&{color:r},m=!c(o)&&{haloWidth:o},g=i&&{haloColor:i},v=s&&{offset:s},b=!c(l)&&{rotate:l},w=u&&{font:a(u)},S=p&&{fontStyle:p},x=h&&{fontWeight:h},E=!c(f)&&{size:f};return n(n(n(n(n(n(n(n(n(n({kind:"Text"},d),y),m),g),v),b),w),S),x),E)},t.prototype.getColorMapFromGeoCSSProperty=function(t){var e=this,r=t["raster-color-map"]&&this.readExpression(t["raster-color-map"]).map((function(t){var r=e.readExpression(t[1]),n=e.readExpression(t[2]),o=e.readExpression(t[3]);return{color:r,quantity:n,label:e.readExpression(t[4]),opacity:o}}));if(r&&0!==r.length){var o=this.readExpression(t["raster-color-map-type"]);return n({type:o||"ramp"},r&&{colorMapEntries:r})}},t.prototype.getContrastEnhancementFromGeoCSSPropertyContrastEnhancement=function(t,e){var r=this.readExpression(t["raster-contrast-enhancement"]),o=this.readExpression(t["raster-gamma"]);if(void 0!==e){var i=a(r),s=a(o);if(3!==i.length&&1!==i.length||3!==s.length&&1!==s.length)throw new Error("\n          optional raster-contrast-enhancement and raster-gamma properties\n          should use one or three values separated by space\n          eg:\n\n          raster-channels: 0 1 2; /* rgb */\n          raster-contrast-enhancement: nomalize nomalize nomalize;\n          raster-gamma: 0.5 0.5 0.5;\n\n          /* or */\n\n          raster-channels: 0 1 2; /* rgb */\n          raster-contrast-enhancement: nomalize;\n          raster-gamma: 0.5;\n\n        ");var u=i[0],p=s[0];void 0!==u&&void 0===i[e]&&this.addWarning("Used first value of raster-contrast-enhancement for all rgb channel"),void 0!==p&&void 0===s[e]&&this.addWarning("Used first value of raster-gamma for all rgb channel");var h=i[e]||u,f=c(s[e])?p:s[e],d=h&&{enhancementType:this.readExpression(h)},y=!c(f)&&{gammaValue:this.readExpression(f)};return n(n({},d),y)}if(l(r)||l(o))throw new Error("\n          optional raster-contrast-enhancement and raster-gamma properties\n          should use one value when used with gray channel\n          eg:\n\n          raster-channels: 0; /* gray */\n          raster-contrast-enhancement: nomalize;\n          raster-gamma: 0.5;\n\n      ");var m=this.readExpression(r),g=this.readExpression(o);if(!c(m)||!c(g)){var v=m&&{enhancementType:m},b=!c(g)&&{gammaValue:g};return n(n({},v),b)}},t.prototype.getChannelFromGeoCSSChannel=function(t,e,r){var o=this.getContrastEnhancementFromGeoCSSPropertyContrastEnhancement(e,r);return n({sourceChannelName:t+""},o&&{contrastEnhancement:o})},t.prototype.getChannelSelectionFromGeoCSSPropertyChannelSelection=function(t){var e=this.readExpression(t["raster-channels"]);if("auto"!==e){if(l(e)&&3===e.length){var r=e[0],n=e[1],o=e[2];return{redChannel:this.getChannelFromGeoCSSChannel(r,t,0),greenChannel:this.getChannelFromGeoCSSChannel(n,t,1),blueChannel:this.getChannelFromGeoCSSChannel(o,t,2)}}if(u(e)||f(e))return{grayChannel:this.getChannelFromGeoCSSChannel(e,t)};throw new Error("\n      Cannot parse raster-channels. It does not match the auto, gray or rgb structure\n      eg:\n\n      raster-channels: auto;\n      raster-channels: 0; /* gray */\n      raster-channels: 7 2 4; /* rgb */\n\n    ")}},t.prototype.getRasterSymbolizerFromGeoCSSRule=function(t){var e=this.readExpression(t["raster-opacity"]),r=this.getColorMapFromGeoCSSProperty(t),o=this.getChannelSelectionFromGeoCSSPropertyChannelSelection(t),i=!o&&this.getContrastEnhancementFromGeoCSSPropertyContrastEnhancement(t),s=!c(e)&&{opacity:e},a=r&&{colorMap:r},l=o&&{channelSelection:o},u=i&&{contrastEnhancement:i};return n(n(n(n({kind:"Raster"},s),a),l),u)},t.prototype.getSymbolizerTypesFromProperties=function(t){var e=[];return t.mark?e.push("point"):!t.stroke||"none"!==t.fill&&t.fill?t.fill&&"none"!==t.fill?e.push("polygon"):void 0!==t["raster-channels"]&&e.push("raster"):e.push("line"),t.label&&e.push("text"),e},t.prototype.getSymbolizersFromRules=function(t){var e=this;return a(t).reduce((function(t,r){var n=e.getSymbolizerTypesFromProperties(r);return i(t,n.reduce((function(t,n){return"point"===n?i(t,[e.getPointSymbolizerFromGeoCSSRule(r)]):"line"===n?i(t,[e.getLineSymbolizerFromGeoCSSRule(r)]):"polygon"===n?i(t,[e.getFillSymbolizerFromGeoCSSRule(r)]):"text"===n?i(t,[e.getTextSymbolizerFromGeoCSSRule(r)]):"raster"===n?i(t,[e.getRasterSymbolizerFromGeoCSSRule(r)]):i(t)}),[]))}),[]).reduce((function(t,e){var r=!!t.find((function(t){return p(t,e)}));return i(t,r?[]:[e])}),[])},t.prototype.getRulesFromGeoCSSSelectors=function(t){for(var e=this,r=[],s=0;s<t.length;s++){var a=t[s],c=r[r.length-1]||{},u=c.group;void 0!==u&&u===a.group?r[r.length-1]=n(n({},c),{properties:i(l(c.properties)?c.properties:[c.properties],[a.properties])}):r.push(a)}return r.map((function(t){var r=t.title,i=void 0===r?"":r,s=t.selector,a=t.properties,l=o(t,["title","selector","properties"]),c=e.getFilterFromSelectors(s),u=e.getScaleDenominatorFromSelectors(l),p=e.getSymbolizersFromRules(a),h=u&&{scaleDenominator:u},f=p&&{symbolizers:p};return n(n(n({name:i},c&&{filter:c}),h),f)}))},t.prototype.geoCSSObjectToGeoStylerStyle=function(t){var e=t.directive,r=void 0===e?{}:e,n=t.rules;return"Flat"!==r["@mode"]&&this.addWarning("Supported only 'Flat' mode, other directive will be translated as flat GeoCSS"),{name:r["@styleTitle"]||"",rules:this.getRulesFromGeoCSSSelectors(n)}},t.prototype.readStyle=function(t){var e=this;return this.warnings=[],new Promise((function(r,n){try{var o=s.read(t);r(e.geoCSSObjectToGeoStylerStyle(o))}catch(t){n(t)}}))},t.prototype.writeStyle=function(t){var e=this;return this.warnings=[],new Promise((function(r,n){try{var o=e.geoStylerStyleToGeoCSSObject(t);r(s.write(o))}catch(t){n(t)}}))},t.prototype.geoStylerStyleToGeoCSSObject=function(t){var e=this.getGeoCSSRulesFromRules(t.rules);return{directive:{"@mode":"Flat","@styleTitle":t.name},rules:e}},t.prototype.getGeoCSSRulesFromRules=function(t){var e=this;return h(t.map((function(t,r){var o=t.name,s=e.getSelectorsFromFilter(t.filter),a=o&&{title:o},l=t.scaleDenominator||{},p=l.min,h=l.max,f=!(!u(p)&&!u(h)),d=u(p)&&{"min-scale":[">",["get","@sd"],p]},y=u(h)&&{"max-scale":["<",["get","@sd"],h]},m=e.getGeoCSSPropertiesFromSymbolizers(t.symbolizers),g=m.reduce((function(t,e){return i(t,Object.keys(e))}),[]);return m.map((function(t){return n(n(n(n({selector:f&&"*"===s?["any",["all"]]:s},a),d),y),{properties:g.reduce((function(r,o){var i;return n(n({},r),((i={})[o]=c(t[o])?":"===o[0]?e.getFisrtValidPesudoselector(o,m):void 0:t[o],i))}),{}),group:r})}))})))},t.prototype.readFilterExpression=function(t){var e=this;if(t){var r=t[0],n=t.slice(1);switch(r){case"||":case"&&":return i([{"||":"any","&&":"all"}[r]],n.map((function(t){return e.readFilterExpression(t)})));case">":case"<":case">=":case"<=":case"!=":case"==":case"*=":return"=="===r&&null===n[1]?["isnull",["get",n[0]]]:[{"==":"==",">":">",">=":">=","<":"<","<=":"<=","!=":"!=","*=":"like"}[r],["get",n[0]],n[1]];default:return}}},t.prototype.getSelectorsFromFilter=function(t){return t?this.readFilterExpression(t):"*"},t.prototype.getGeoCSSPropertiesFromSymbolizers=function(t){var e=this;return t.map((function(t){switch(t.kind){case"Mark":return e.getGeoCSSPropertiesFromMarkSymbolizer(t);case"Icon":return e.getGeoCSSPropertiesFromIconSymbolizer(t);case"Text":return e.getGeoCSSPropertiesFromTextSymbolizer(t);case"Line":return e.getGeoCSSPropertiesFromLineSymbolizer(t);case"Fill":return e.getGeoCSSPropertiesFromFillSymbolizer(t);case"Raster":return e.getGeoCSSPropertiesFromRasterSymbolizer(t);default:return null}})).filter((function(t){return t}))},t.prototype.getGeoCSSPropertiesFromMarkSymbolizer=function(t,e){var r,o,i,s;void 0===e&&(e="mark");var a=t.wellKnownName&&["symbol",t.wellKnownName.toLowerCase()],l=t.opacity,u=void 0!==t.radius&&2*t.radius,p=t.rotate,h=t.color&&["hex",t.color],f=t.fillOpacity,d=t.strokeColor&&["hex",t.strokeColor],y=t.strokeWidth,m=t.strokeOpacity,g=h||d,v=a&&((r={})[e]=a,r),b="mark"===e&&!c(l)&&{"mark-opacity":l},w=!g&&!1!==u&&!c(u)&&((o={})[e+"-size"]=u,o),S=!g&&!c(p)&&((i={})[e+"-rotation"]=p,i),x=h&&{fill:h},E=f&&{"fill-opacity":f},O=d&&{stroke:d},F=y&&{"stroke-width":y},C=m&&{"stroke-opacity":m},k=!1!==u&&!c(u)&&{size:u},P=!c(p)&&{rotation:p},D=g&&((s={})[":"+e]=n(n(n(n(n(n(n({},x),E),O),F),C),k),P),s);return n(n(n(n(n({},v),b),w),S),D)},t.prototype.getGeoCSSPropertiesFromIconSymbolizer=function(t,e){var r,o,i,s;void 0===e&&(e="mark");var a=t.image&&["url",t.image],l=t.opacity,u=t.size,p=t.rotate,h=a&&((r={})[e]=a,r),f="mark"===e&&!c(l)&&((o={})[e+"-opacity"]=l,o),d=!c(u)&&((i={})[e+"-size"]=u,i),y=!c(p)&&((s={})[e+"-rotation"]=p,s);return n(n(n(n({},h),f),d),y)},t.prototype.getGeoCSSLabelPropertyFromTextSymbolizer=function(t){if(t){var e=t.split(/(\{\{)|(\}\})/g).filter((function(t){return t}));return e.map((function(t,r){return"{{"===t||"}}"===t?null:"{{"===e[r-1]&&"}}"===e[r+1]?["brace",["get",t]]:t})).filter((function(t){return null!==t}))}},t.prototype.getGeoCSSPropertiesFromTextSymbolizer=function(t){var e=this.getGeoCSSLabelPropertyFromTextSymbolizer(t.label),r=t.font,o=t.color&&["hex",t.color],s=t.size,a=t.fontStyle,l=t.fontWeight,u=t.offset&&i(["array"],t.offset),p=t.rotate,h=t.haloWidth,f=t.haloColor&&["hex",t.haloColor],d=e&&{label:i(["text"],e)},y=r&&{"font-family":i(["array"],r)},m=o&&{"font-fill":o},g=!c(s)&&{"font-size":s},v=a&&{"font-style":["get",a]},b=l&&{"font-weight":["get",l]},w=u&&{"label-offset":u},S=!c(p)&&{"label-rotation":p},x=!c(h)&&{"halo-radius":h},E=f&&{"halo-color":f};return n(n(n(n(n(n(n(n(n(n({},d),w),S),y),m),g),v),b),x),E)},t.prototype.getGeoCSSPropertiesFromLineSymbolizer=function(t){var e=t.color&&["hex",t.color],r=t.width,o=t.opacity,s=t.join,a=t.cap,l=t.dasharray&&i(["array"],t.dasharray),u=t.dashOffset,p=t.graphicStroke?"Mark"===t.graphicStroke.kind?this.getGeoCSSPropertiesFromMarkSymbolizer(t.graphicStroke,"stroke"):"Icon"===t.graphicStroke.kind?this.getGeoCSSPropertiesFromIconSymbolizer(t.graphicStroke,"stroke"):void 0:void 0,h=!p&&e&&{stroke:e},f=!c(r)&&{"stroke-width":r},d=!c(o)&&{"stroke-opacity":o},y=s&&{"stroke-linejoin":s},m=a&&{"stroke-linecap":a},g=l&&{"stroke-dasharray":l},v=u&&{"stroke-dashoffset":u};return n(n(n(n(n(n(n(n({},h),f),d),y),m),g),v),p)},t.prototype.getGeoCSSPropertiesFromFillSymbolizer=function(t){var e=t.color&&["hex",t.color],r=t.fillOpacity,o=t.outlineColor&&["hex",t.outlineColor],s=t.outlineWidth,a=t.outlineOpacity,l=t.outlineDasharray&&i(["array"],t.outlineDasharray),u=t.graphicFill?"Mark"===t.graphicFill.kind?this.getGeoCSSPropertiesFromMarkSymbolizer(t.graphicFill,"fill"):"Icon"===t.graphicFill.kind?this.getGeoCSSPropertiesFromIconSymbolizer(t.graphicFill,"fill"):void 0:void 0,p=!u&&e&&{fill:e},h=!c(r)&&{"fill-opacity":r},f=o&&{stroke:o},d=!c(s)&&{"stroke-width":s},y=!c(a)&&{"stroke-opacity":a},m=l&&{"stroke-dasharray":l};return n(n(n(n(n(n(n({},p),h),f),d),y),m),u)},t.prototype.getGeoCSSColorMapFromColorMap=function(t){if(t){var e=t.colorMapEntries&&t.colorMapEntries.length>0&&t.colorMapEntries.map((function(t){return["color-map-entry",["hex",t.color],t.quantity,t.opacity,t.label].filter((function(t){return!c(t)}))})).filter((function(t){return t.length>1})),r=t.type&&{"raster-color-map-type":["get",t.type]},o=e&&e.length>0&&{"raster-color-map":i(["array"],e)};return n(n({},r),o)}},t.prototype.getGeoCSSChannelSelectionFromChannelSelection=function(t){var e=t&&t.redChannel,r=t&&t.greenChannel,o=t&&t.blueChannel;if(e&&r&&o){var i=e.sourceChannelName,s=r.sourceChannelName,a=o.sourceChannelName,l=e.contrastEnhancement,u=l.enhancementType,p=l.gammaValue,h=r.contrastEnhancement,f=h.enhancementType,d=h.gammaValue,y=o.contrastEnhancement,m=y.enhancementType,g=y.gammaValue,v=u&&f&&m&&{"raster-contrast-enhancement":["array",["get",u],["get",f],["get",m]]},b=!c(p)&&!c(d)&&!c(g)&&{"raster-gamma":["array",p,d,g]};return n(n({"raster-channels":["array",parseFloat(i),parseFloat(s),parseFloat(a)]},v),b)}var w=t&&t.grayChannel;if(w){var S=w.sourceChannelName,x=w.contrastEnhancement,E=x.enhancementType,O=x.gammaValue;return v=E&&{"raster-contrast-enhancement":["get",E]},b=!c(O)&&{"raster-gamma":O},n(n({"raster-channels":parseFloat(S)},v),b)}return{"raster-channels":["get","auto"]}},t.prototype.getGeoCSSPropertiesFromRasterSymbolizer=function(t){var e=!c(t.opacity)&&{"raster-opacity":t.opacity},r=this.getGeoCSSColorMapFromColorMap(t.colorMap),o=this.getGeoCSSChannelSelectionFromChannelSelection(t.channelSelection),i=t&&t.contrastEnhancement||{},s=i.enhancementType,a=i.gammaValue,l=o["raster-channels"]&&"auto"===o["raster-channels"][1],u=l&&s&&{"raster-contrast-enhancement":["get",s]},p=l&&!c(a)&&{"raster-gamma":a};return n(n(n(n(n({},o),u),p),e),r)},t.title="GeoCSS Style Parser",t.combinationMap={all:"&&",any:"||"},t.comparisonMap={"==":"==",">":">",">=":">=","<":"<","<=":"<=","!=":"!=",like:"*=",ilike:"*="},t}();e.GeoCSSStyleParser=y,e.default=y},42757:function(t,e,r){"use strict";var n=this&&this.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n};Object.defineProperty(e,"__esModule",{value:!0});var o=r(87970),i=r(47037),s=r(81763),a=r(27361),l=r(36968),c=r(41609),u=function(){function t(t){this.title="SLD Style Parser",this._numericFilterFields=[],this._boolFilterFields=[],this._forceCasting=!1,this._prettyOutput=!0,this.getTextSymbolizerLabelFromSldSymbolizer=function(t){var e="",r=a(t,"Literal"),n=a(t,"PropertyName"),o="Literal"===Object.keys(t)[0];if(n&&n.length>0){var i=n.map((function(t){return"{{"+t+"}}"}));r&&r.length>0?o?(r.forEach((function(t,r){e+=""+t,i[r]&&(e+=""+i[r])})),i.length>r.length&&(e+=i.join(""))):(i.forEach((function(t,n){e+=""+t,r[n]&&(e+=""+r[n])})),r.length>i.length&&(e+=r.join(""))):e=i.join("")}else r&&r.length>0?e=r.join(""):"string"==typeof t&&(e=t);return e},this.getSldLabelFromTextSymbolizer=function(t){var e=new RegExp("\\{\\{.*?\\}\\}","g"),r=t.match(e),n=t.startsWith("{{");if(r){var o=t.split(e),i=[];o.forEach((function(t){0!==t.length&&i.push(t)}));var s=r.map((function(t){return t.slice(2,t.length-2)}));return n?[{"ogc:PropertyName":s,"ogc:Literal":i}]:[{"ogc:Literal":i,"ogc:PropertyName":s}]}return[{"ogc:Literal":[t]}]},Object.assign(this,t)}return Object.defineProperty(t.prototype,"numericFilterFields",{get:function(){return this._numericFilterFields},set:function(t){this._numericFilterFields=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boolFilterFields",{get:function(){return this._boolFilterFields},set:function(t){this._boolFilterFields=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"forceCasting",{get:function(){return this._forceCasting},set:function(t){this._forceCasting=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"prettyOutput",{get:function(){return this._prettyOutput},set:function(t){this._prettyOutput=t},enumerable:!0,configurable:!0}),t.keysByValue=function(t,e){return Object.keys(t).filter((function(r){return t[r]===e}))},t.prototype.tagNameProcessor=function(t){var e=new RegExp(/(?!xmlns)^.*:/);return t.replace(e,"")},t.prototype.getStyleNameFromSldObject=function(t){var e=a(t,"StyledLayerDescriptor.NamedLayer[0].UserStyle[0].Title[0]"),r=a(t,"StyledLayerDescriptor.NamedLayer[0].Name[0]");return e||r||""},t.prototype.getStrMatchesFunctionFilterFromSldFilter=function(t){var e=a(t,"Function[0].PropertyName[0]"),r=a(t,"Function[0].Literal[0]");return["FN_strMatches",e,new RegExp(r)]},t.prototype.getFunctionFilterFromSldFilter=function(t){return a(t,"Function[0].$.name"),this.getStrMatchesFunctionFilterFromSldFilter(t)},t.prototype.getFilterFromOperatorAndComparison=function(e,r){var o,s=this;if(Object.keys(t.comparisonMap).includes(e)){var a=t.comparisonMap[e],l=!!r.Function,c=l?this.getFunctionFilterFromSldFilter(r):r.PropertyName[0],u=null;if("PropertyIsNull"!==e&&(u=r.Literal[0]),(this.forceCasting||l||-1!==this.numericFilterFields.indexOf(c))&&!Number.isNaN(parseFloat(u))&&(u=parseFloat(u)),i(u)){var p=u.toLowerCase();(this.forceCasting||l||-1!==this.boolFilterFields.indexOf(c))&&("false"===p&&(u=!1),"true"===p&&(u=!0))}o=[a,c,u]}else if(Object.keys(t.combinationMap).includes(e)){var h=t.combinationMap[e],f=[];Object.keys(r).forEach((function(t){1===r[t].length?f.push(s.getFilterFromOperatorAndComparison(t,r[t][0])):r[t].forEach((function(e){f.push(s.getFilterFromOperatorAndComparison(t,e))}))})),o=n([h],f)}else{if(!Object.keys(t.negationOperatorMap).includes(e))throw new Error("No Filter detected");var d=t.negationOperatorMap[e],y=Object.keys(r)[0],m=r[y][0];o=[d,this.getFilterFromOperatorAndComparison(y,m)]}return o},t.prototype.getFilterFromRule=function(t){var e=t.Filter;if(e){var r=e[0],n=Object.keys(r).find((function(t,e){return"$"!==t}));if(n){var o=r[n][0];return this.getFilterFromOperatorAndComparison(n,o)}}},t.prototype.getScaleDenominatorFromRule=function(t){var e={};return t.MinScaleDenominator&&(e.min=parseFloat(t.MinScaleDenominator[0])),t.MaxScaleDenominator&&(e.max=parseFloat(t.MaxScaleDenominator[0])),e.min||e.max?e:void 0},t.prototype.getMarkSymbolizerFromSldSymbolizer=function(t){var e=a(t,"Graphic[0].Mark[0].WellKnownName[0]"),r=a(t,"Graphic[0].Mark[0].Stroke[0].CssParameter")||[];0===r.length&&(r=a(t,"Graphic[0].Mark[0].Stroke[0].SvgParameter")||[]);var n=a(t,"Graphic[0].Opacity[0]"),o=a(t,"Graphic[0].Size[0]"),i=a(t,"Graphic[0].Rotation[0]"),s=a(t,"Graphic[0].Mark[0].Fill[0].CssParameter")||[];0===s.length&&(s=a(t,"Graphic[0].Mark[0].Fill[0].SvgParameter")||[]);var l=s.findIndex((function(t){return"fill"===t.$.name})),c=a(t,"Graphic[0].Mark[0].Fill[0].CssParameter["+l+"]._");if(!c){var u=a(t,"Graphic[0].Mark[0].Fill[0].SvgParameter["+l+"]._");u&&(c=u)}var p=s.findIndex((function(t){return"fill-opacity"===t.$.name})),h=a(t,"Graphic[0].Mark[0].Fill[0].CssParameter["+p+"]._"),f={kind:"Mark"};switch(n&&(f.opacity=parseFloat(n)),h&&(f.fillOpacity=parseFloat(h)),c&&(f.color=c),i&&(f.rotate=parseFloat(i)),o&&(f.radius=parseFloat(o)/2),e){case"circle":case"square":case"triangle":case"star":case"cross":case"x":var d=e.charAt(0).toUpperCase()+e.slice(1);f.wellKnownName=d;break;case"shape://vertline":case"shape://horline":case"shape://slash":case"shape://backslash":case"shape://dot":case"shape://plus":case"shape://times":case"shape://oarrow":case"shape://carrow":f.wellKnownName=e;break;default:throw new Error("MarkSymbolizer cannot be parsed. Unsupported WellKnownName.")}return r.forEach((function(t){switch(t.$.name){case"stroke":f.strokeColor=t._;break;case"stroke-width":f.strokeWidth=parseFloat(t._);break;case"stroke-opacity":f.strokeOpacity=parseFloat(t._)}})),f},t.prototype.getIconSymbolizerFromSldSymbolizer=function(t){var e={kind:"Icon",image:a(t,"Graphic[0].ExternalGraphic[0].OnlineResource[0]").$["xlink:href"]},r=a(t,"Graphic[0].Opacity[0]"),n=a(t,"Graphic[0].Size[0]"),o=a(t,"Graphic[0].Rotation[0]");return r&&(e.opacity=r),n&&(e.size=parseFloat(n)),o&&(e.rotate=parseFloat(o)),e},t.prototype.getPointSymbolizerFromSldSymbolizer=function(t){var e={},r=a(t,"Graphic[0].Mark[0].WellKnownName[0]");return a(t,"Graphic[0].ExternalGraphic[0]")?e=this.getIconSymbolizerFromSldSymbolizer(t):(r||l(t,"Graphic[0].Mark[0].WellKnownName[0]","square"),e=this.getMarkSymbolizerFromSldSymbolizer(t)),e},t.prototype.getLineSymbolizerFromSldSymbolizer=function(t){var e=this,r={kind:"Line"},n=Object.keys(a(t,"Stroke[0]"))||[];if(n.length<1)throw new Error("LineSymbolizer cannot be parsed. No Stroke detected");n.forEach((function(n){switch(n){case"CssParameter":case"SvgParameter":var o=a(t,"Stroke[0].CssParameter")||[];if(0===o.length&&(o=a(t,"Stroke[0].SvgParameter")||[]),o.length<1)throw new Error("LineSymbolizer can not be parsed. No CssParameters detected.");o.forEach((function(t){var e=t.$.name,n=t._;switch(e){case"stroke":r.color=n;break;case"stroke-width":r.width=parseFloat(n);break;case"stroke-opacity":r.opacity=parseFloat(n);break;case"stroke-linejoin":r.join="mitre"===n?"miter":n;break;case"stroke-linecap":r.cap=n;break;case"stroke-dasharray":var o=n.split(" ").map((function(t){return parseFloat(t)}));r.dasharray=o;break;case"stroke-dashoffset":r.dashOffset=parseFloat(n)}}));break;case"GraphicStroke":r.graphicStroke=e.getPointSymbolizerFromSldSymbolizer(t.Stroke[0].GraphicStroke[0]);break;case"GraphicFill":r.graphicFill=e.getPointSymbolizerFromSldSymbolizer(t.Stroke[0].GraphicFill[0])}}));var o=a(t,"PerpendicularOffset[0]");return void 0!==o&&(r.perpendicularOffset=Number(o)),r},t.prototype.getFillSymbolizerFromSldSymbolizer=function(t){var e={kind:"Fill"},r=a(t,"Fill[0].CssParameter")||[];0===r.length&&(r=a(t,"Fill[0].SvgParameter")||[]);var n=a(t,"Stroke[0].CssParameter")||[];0===n.length&&(n=a(t,"Stroke[0].SvgParameter")||[]);var o=a(t,"Fill[0].GraphicFill[0]");return o&&(e.graphicFill=this.getPointSymbolizerFromSldSymbolizer(o)),r.forEach((function(t){var r=t.$.name,n=t._;switch(r){case"fill":e.color=n;break;case"fill-opacity":e.fillOpacity=parseFloat(n)}})),e.color||(e.opacity=0),n.forEach((function(t){var r=t.$.name,n=t._;if("stroke"===r)e.outlineColor=n;else if("stroke-width"===r)e.outlineWidth=parseFloat(n);else if("stroke-opacity"===r)e.outlineOpacity=parseFloat(n);else if("stroke-dasharray"===r){var o=n.split(" "),i=[];o.forEach((function(t){i.push(parseFloat(t))})),e.outlineDasharray=i}})),e},t.prototype.getColorMapFromSldColorMap=function(t){var e={},r=a(t,"$.type");e.type=r||"ramp";var n=a(t,"$.extended");n&&(e.extended="true"===n);var o=a(t,"ColorMapEntry");if(Array.isArray(o)){var i=o.map((function(t){var e=a(t,"$.color");if(!e)throw new Error("Cannot parse ColorMapEntries. color is undefined.");var r=a(t,"$.quantity");r&&(r=parseFloat(r));var n=a(t,"$.label"),o=a(t,"$.opacity");return o&&(o=parseFloat(o)),{color:e,quantity:r,label:n,opacity:o}}));e.colorMapEntries=i}return e},t.prototype.getContrastEnhancementFromSldContrastEnhancement=function(t){var e={},r=void 0!==t.Histogram,n=void 0!==t.Normalize;if(r&&n)throw new Error("Cannot parse ContrastEnhancement. Histogram and Normalize\n      are mutually exclusive.");r?e.enhancementType="histogram":n&&(e.enhancementType="normalize");var o=a(t,"GammaValue[0]");return o&&(o=parseFloat(o)),e.gammaValue=o,e},t.prototype.getChannelFromSldChannel=function(t){var e={sourceChannelName:a(t,"SourceChannelName[0]")},r=a(t,"ContrastEnhancement[0]");return r&&(e.contrastEnhancement=this.getContrastEnhancementFromSldContrastEnhancement(r)),e},t.prototype.getChannelSelectionFromSldChannelSelection=function(t){var e,r=a(t,"RedChannel[0]"),n=a(t,"BlueChannel[0]"),o=a(t,"GreenChannel[0]"),i=a(t,"GrayChannel[0]");if(i&&r&&n&&o)throw new Error("Cannot parse ChannelSelection. RGB and Grayscale are mutually exclusive");if(i)e={grayChannel:this.getChannelFromSldChannel(i)};else{if(!(r&&o&&n))throw new Error("Cannot parse ChannelSelection. Red, Green and Blue channels must be defined.");e={redChannel:this.getChannelFromSldChannel(r),blueChannel:this.getChannelFromSldChannel(n),greenChannel:this.getChannelFromSldChannel(o)}}return e},t.prototype.getRasterSymbolizerFromSldSymbolizer=function(t){var e={kind:"Raster"},r=a(t,"Opacity[0]");r&&(r=parseFloat(r),e.opacity=r);var n=a(t,"ColorMap")||[];if(n.length>0){var o=this.getColorMapFromSldColorMap(n[0]);e.colorMap=o}var i=a(t,"ChannelSelection")||[];if(i.length>0){var s=this.getChannelSelectionFromSldChannelSelection(i[0]);e.channelSelection=s}var l=a(t,"ContrastEnhancement")||[];if(l.length>0){var c=this.getContrastEnhancementFromSldContrastEnhancement(l[0]);e.contrastEnhancement=c}return e},t.prototype.getTextSymbolizerFromSldSymbolizer=function(t){var e={kind:"Text"},r=a(t,"Font[0].CssParameter")||[];0===r.length&&(r=a(t,"Font[0].SvgParameter")||[]);var n=a(t,"Label[0]");n&&(e.label=this.getTextSymbolizerLabelFromSldSymbolizer(n));var o=a(t,"Fill[0].CssParameter[0]._");o||(o=a(t,"Fill[0].SvgParameter[0]._"));var i=a(t,"Halo[0].Fill[0].CssParameter")||[];0===i.length&&(i=a(t,"Halo[0].Fill[0].SvgParameter")||[]);var s=a(t,"Halo[0].Radius[0]");o&&(e.color=o),s&&(e.haloWidth=parseFloat(s)),i.forEach((function(t){var r=t.$.name,n=t._;"fill"===r&&(e.haloColor=n)}));var l=a(t,"LabelPlacement[0].PointPlacement[0].Displacement[0]");if(l){var c=l.DisplacementX[0],u=l.DisplacementY[0];e.offset=[c?parseFloat(c):0,u?parseFloat(u):0]}var p=a(t,"LabelPlacement[0].PointPlacement[0].Rotation[0]");return p&&(e.rotate=parseFloat(p)),r.forEach((function(t){var r=t.$.name,n=t._;switch(r){case"font-family":e.font=[n];break;case"font-style":e.fontStyle=n;break;case"font-weight":e.fontWeight=n;break;case"font-size":e.size=parseFloat(n)}})),e},t.prototype.getSymbolizersFromRule=function(t){var e=this,r=[];return Object.keys(t).filter((function(t){return t.endsWith("Symbolizer")})).forEach((function(n){t[n].forEach((function(t){var o;switch(n){case"PointSymbolizer":o=e.getPointSymbolizerFromSldSymbolizer(t);break;case"LineSymbolizer":o=e.getLineSymbolizerFromSldSymbolizer(t);break;case"TextSymbolizer":o=e.getTextSymbolizerFromSldSymbolizer(t);break;case"PolygonSymbolizer":o=e.getFillSymbolizerFromSldSymbolizer(t);break;case"RasterSymbolizer":o=e.getRasterSymbolizerFromSldSymbolizer(t);break;default:throw new Error("Failed to parse SymbolizerKind from SldRule")}r.push(o)}))})),r},t.prototype.getRulesFromSldObject=function(t){var e=this,r=t.StyledLayerDescriptor.NamedLayer,n=[];return r.forEach((function(t){t.UserStyle.forEach((function(t){t.FeatureTypeStyle.forEach((function(t){t.Rule.forEach((function(t){var r=e.getFilterFromRule(t),o=e.getScaleDenominatorFromRule(t),i=e.getSymbolizersFromRule(t),s={name:t.Title?t.Title[0]:t.Name?t.Name[0]:""};r&&(s.filter=r),o&&(s.scaleDenominator=o),i&&(s.symbolizers=i),n.push(s)}))}))}))})),n},t.prototype.sldObjectToGeoStylerStyle=function(t){var e=this.getRulesFromSldObject(t);return{name:this.getStyleNameFromSldObject(t),rules:e}},t.prototype.readStyle=function(t){var e=this;return new Promise((function(r,n){var i={tagNameProcessors:[e.tagNameProcessor]};try{o.parseString(t,i,(function(t,o){t&&n("Error while parsing sldString: "+t);var i=e.sldObjectToGeoStylerStyle(o);r(i)}))}catch(t){n(t)}}))},t.prototype.writeStyle=function(t){var e=this;return new Promise((function(r,n){try{var i={renderOpts:{pretty:e.prettyOutput}},s=new o.Builder(i),a=e.geoStylerStyleToSldObject(t);r(s.buildObject(a))}catch(t){n(t)}}))},t.prototype.geoStylerStyleToSldObject=function(t){var e=this.getSldRulesFromRules(t.rules);return e.forEach((function(t){t.Filter&&!t.Filter.$&&(t.Filter.$={xmlns:"http://www.opengis.net/ogc"})})),{StyledLayerDescriptor:{$:{version:"1.0.0","xsi:schemaLocation":"http://www.opengis.net/sld StyledLayerDescriptor.xsd",xmlns:"http://www.opengis.net/sld","xmlns:ogc":"http://www.opengis.net/ogc","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"},NamedLayer:[{Name:[t.name||""],UserStyle:[{Name:[t.name||""],Title:[t.name||""],FeatureTypeStyle:[{Rule:e}]}]}]}}},t.prototype.getSldRulesFromRules=function(t){var e=this;return t.map((function(t){var r={Name:[t.name]};if(t.filter){var n=e.getSldFilterFromFilter(t.filter);r.Filter=n}if(t.scaleDenominator){var o=t.scaleDenominator,i=o.min,a=o.max;i&&s(i)&&(r.MinScaleDenominator=[i.toString()]),a&&s(a)&&(r.MaxScaleDenominator=[a.toString()])}var l=e.getSldSymbolizersFromSymbolizers(t.symbolizers),c=[];return l.length>0&&(c=Object.keys(l[0])),c.forEach((function(t){0===l[0][t].length&&delete l[0][t]})),l.length>0&&0!==Object.keys(l[0]).length&&(r=Object.assign(r,l[0])),r}))},t.prototype.getSldSymbolizersFromSymbolizers=function(t){var e=this,r=[],n={};return t.forEach((function(t){var o;switch(t.kind){case"Mark":n.PointSymbolizer||(n.PointSymbolizer=[]),o=e.getSldPointSymbolizerFromMarkSymbolizer(t),a(o,"PointSymbolizer[0]")&&n.PointSymbolizer.push(a(o,"PointSymbolizer[0]"));break;case"Icon":n.PointSymbolizer||(n.PointSymbolizer=[]),o=e.getSldPointSymbolizerFromIconSymbolizer(t),a(o,"PointSymbolizer[0]")&&n.PointSymbolizer.push(a(o,"PointSymbolizer[0]"));break;case"Text":n.TextSymbolizer||(n.TextSymbolizer=[]),o=e.getSldTextSymbolizerFromTextSymbolizer(t),a(o,"TextSymbolizer[0]")&&n.TextSymbolizer.push(a(o,"TextSymbolizer[0]"));break;case"Line":n.LineSymbolizer||(n.LineSymbolizer=[]),o=e.getSldLineSymbolizerFromLineSymbolizer(t),a(o,"LineSymbolizer[0]")&&n.LineSymbolizer.push(a(o,"LineSymbolizer[0]"));break;case"Fill":n.PolygonSymbolizer||(n.PolygonSymbolizer=[]),o=e.getSldPolygonSymbolizerFromFillSymbolizer(t),a(o,"PolygonSymbolizer[0]")&&n.PolygonSymbolizer.push(a(o,"PolygonSymbolizer[0]"));break;case"Raster":n.RasterSymbolizer||(n.RasterSymbolizer=[]),o=e.getSldRasterSymbolizerFromRasterSymbolizer(t),a(o,"RasterSymbolizer[0]")&&n.RasterSymbolizer.push(a(o,"RasterSymbolizer[0]"))}r.push(n)})),r},t.prototype.getSldTextSymbolizerFromTextSymbolizer=function(t){var e=[{Label:t.label?this.getSldLabelFromTextSymbolizer(t.label):void 0}],r={font:"font-family",size:"font-size",fontStyle:"font-style",fontWeight:"font-weight"},n=Object.keys(t).filter((function(t){return"kind"!==t&&r[t]})).map((function(e){return{_:"font"===e?t[e][0]:t[e],$:{name:r[e]}}}));if(n.length>0&&(e[0].Font=[{CssParameter:n}]),t.offset||void 0!==t.rotate){var o=[{}];t.offset&&(o[0].Displacement=[{DisplacementX:[t.offset[0].toString()],DisplacementY:[t.offset[1].toString()]}]),void 0!==t.rotate&&(o[0].Rotation=[t.rotate.toString()]),e[0].LabelPlacement=[{PointPlacement:o}]}if(t.color&&(e[0].Fill=[{CssParameter:[{_:t.color,$:{name:"fill"}}]}]),t.haloWidth||t.haloColor){var i={},s=[];t.haloWidth&&(i.Radius=[t.haloWidth.toString()]),t.haloColor&&s.push({_:t.haloColor,$:{name:"fill"}}),s.length>0&&(i.Fill=[{CssParameter:s}]),e[0].Halo=[i]}return{TextSymbolizer:e}},t.prototype.getSldPolygonSymbolizerFromFillSymbolizer=function(t){var e,r={outlineColor:"stroke",outlineWidth:"stroke-width",outlineOpacity:"stroke-opacity",outlineDasharray:"stroke-dasharray"},n={color:"fill",fillOpacity:"fill-opacity"},o=[],i=[];a(t,"graphicFill")&&("Mark"===a(t,"graphicFill.kind")?e=this.getSldPointSymbolizerFromMarkSymbolizer(t.graphicFill):"Icon"===a(t,"graphicFill.kind")&&(e=this.getSldPointSymbolizerFromIconSymbolizer(t.graphicFill))),Object.keys(t).filter((function(t){return"kind"!==t})).filter((function(e){return void 0!==t[e]&&null!==t[e]})).forEach((function(e){if(Object.keys(n).includes(e))i.push({_:t[e],$:{name:n[e]}});else if(Object.keys(r).includes(e)){var s="";if("outlineDasharray"===e){var a=t[e];s="",a.forEach((function(t,e){s+=t,e<a.length-1&&(s+=" ")}))}else s="outlineWidth"===e||"outlineOpacity"===e?t[e]+"":t[e];o.push({_:s,$:{name:r[e]}})}}));var s=[{}];return(i.length>0||e)&&(s[0].Fill=[{}],e&&(s[0].Fill[0].GraphicFill=[e.PointSymbolizer[0]]),i.length>0&&(s[0].Fill[0].CssParameter=i)),o.length>0&&(s[0].Stroke=[{CssParameter:o}]),{PolygonSymbolizer:s}},t.prototype.getSldLineSymbolizerFromLineSymbolizer=function(t){var e={color:"stroke",width:"stroke-width",opacity:"stroke-opacity",join:"stroke-linejoin",cap:"stroke-linecap",dasharray:"stroke-dasharray",dashOffset:"stroke-dashoffset"},r={LineSymbolizer:[{Stroke:[{}]}]},n=Object.keys(t).filter((function(r){return"kind"!==r&&e[r]&&void 0!==t[r]&&null!==t[r]})).map((function(r){var n=t[r];return"dasharray"===r&&(n=t.dasharray?t.dasharray.join(" "):void 0),"join"===r&&"miter"===n&&(n="mitre"),{_:n,$:{name:e[r]}}})),o=t.perpendicularOffset;if(a(t,"graphicStroke"))if("Mark"===a(t,"graphicStroke.kind")){var i=this.getSldPointSymbolizerFromMarkSymbolizer(t.graphicStroke);r.LineSymbolizer[0].Stroke[0].GraphicStroke=[i.PointSymbolizer[0]]}else"Icon"===a(t,"graphicStroke.kind")&&(i=this.getSldPointSymbolizerFromIconSymbolizer(t.graphicStroke),r.LineSymbolizer[0].Stroke[0].GraphicStroke=[i.PointSymbolizer[0]]);if(a(t,"graphicFill"))if("Mark"===a(t,"graphicFill.kind")){var s=this.getSldPointSymbolizerFromMarkSymbolizer(t.graphicFill);r.LineSymbolizer[0].Stroke[0].GraphicFill=[s.PointSymbolizer[0]]}else"Icon"===a(t,"graphicFill.kind")&&(s=this.getSldPointSymbolizerFromIconSymbolizer(t.graphicFill),r.LineSymbolizer[0].Stroke[0].GraphicFill=[s.PointSymbolizer[0]]);return 0!==n.length&&(r.LineSymbolizer[0].Stroke[0].CssParameter=n),o&&(r.LineSymbolizer[0].PerpendicularOffset=[o]),r},t.prototype.getSldPointSymbolizerFromMarkSymbolizer=function(t){var e=[{WellKnownName:[t.wellKnownName.toLowerCase()]}];if(t.color||t.fillOpacity){var r=[];t.color&&r.push({_:t.color,$:{name:"fill"}}),t.fillOpacity&&r.push({_:t.fillOpacity,$:{name:"fill-opacity"}}),e[0].Fill=[{CssParameter:r}]}if(t.strokeColor||t.strokeWidth||t.strokeOpacity){e[0].Stroke=[{}];var n=[];t.strokeColor&&n.push({_:t.strokeColor,$:{name:"stroke"}}),t.strokeWidth&&n.push({_:t.strokeWidth.toString(),$:{name:"stroke-width"}}),t.strokeOpacity&&n.push({_:t.strokeOpacity.toString(),$:{name:"stroke-opacity"}}),e[0].Stroke[0].CssParameter=n}var o=[{Mark:e}];return t.opacity&&(o[0].Opacity=[t.opacity.toString()]),t.radius&&(o[0].Size=[(2*t.radius).toString()]),t.rotate&&(o[0].Rotation=[t.rotate.toString()]),{PointSymbolizer:[{Graphic:o}]}},t.prototype.getSldPointSymbolizerFromIconSymbolizer=function(t){var e=[{ExternalGraphic:[{OnlineResource:[{$:{"xlink:type":"simple","xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":t.image}}]}]}];if(t.image){var r=t.image.split(".").pop();switch(r){case"png":case"jpeg":case"gif":e[0].ExternalGraphic[0].Format=["image/"+r];break;case"jpg":e[0].ExternalGraphic[0].Format=["image/jpeg"];break;case"svg":e[0].ExternalGraphic[0].Format=["image/svg+xml"]}}return t.opacity&&(e[0].Opacity=t.opacity),t.size&&(e[0].Size=t.size),t.rotate&&(e[0].Rotation=t.rotate),{PointSymbolizer:[{Graphic:e}]}},t.prototype.getSldRasterSymbolizerFromRasterSymbolizer=function(t){var e,r,n,o,i=[{}];return void 0!==t.opacity&&(e=[t.opacity.toString()],i[0].Opacity=e),t.colorMap&&(r=this.getSldColorMapFromColorMap(t.colorMap),c(r[0])||(i[0].ColorMap=r)),t.channelSelection&&(n=this.getSldChannelSelectionFromChannelSelection(t.channelSelection),c(n[0])||(i[0].ChannelSelection=n)),t.contrastEnhancement&&(o=this.getSldContrastEnhancementFromContrastEnhancement(t.contrastEnhancement),c(o[0])||(i[0].ContrastEnhancement=o)),{RasterSymbolizer:i}},t.prototype.getSldColorMapFromColorMap=function(t){var e=[{$:{}}];if(t.type){var r=t.type;e[0].$.type=r}if(void 0!==t.extended){var n=t.extended.toString();e[0].$.extended=n}if(t.colorMapEntries&&t.colorMapEntries.length>0){var o=t.colorMapEntries.map((function(t){var e={$:{}};return t.color&&(e.$.color=t.color),void 0!==t.quantity&&(e.$.quantity=t.quantity.toString()),t.label&&(e.$.label=t.label),void 0!==t.opacity&&(e.$.opacity=t.opacity.toString()),e})).filter((function(t){return Object.keys(t.$).length>0}));e[0].ColorMapEntry=o}return e},t.prototype.getSldChannelSelectionFromChannelSelection=function(t){var e=this,r={redChannel:"RedChannel",blueChannel:"BlueChannel",greenChannel:"GreenChannel",grayChannel:"GrayChannel"},n=Object.keys(t),o=[{}];return n.forEach((function(n){var i=[{}],s=a(t,n+".sourceChannelName"),l=a(t,n+".contrastEnhancement");(s||l)&&(s&&(i[0].SourceChannelName=[s]),l&&(i[0].ContrastEnhancement=e.getSldContrastEnhancementFromContrastEnhancement(l)),o[0][r[n]]=i)})),o},t.prototype.getSldContrastEnhancementFromContrastEnhancement=function(t){var e=[{}],r=a(t,"enhancementType");return"normalize"===r?e[0].Normalize=[""]:"histogram"===r&&(e[0].Histogram=[""]),void 0!==t.gammaValue&&(e[0].GammaValue=[t.gammaValue.toString()]),e},t.prototype.getSldStrMatchesFunctionFromFunctionFilter=function(t){return{$:{name:"strMatches"},PropertyName:[t[1]],Literal:[t[2].toString().replace(/\//g,"")]}},t.prototype.getSldFunctionFilterFromFunctionFilter=function(t){if("strMatches"===t[0].split("FN_")[1])return this.getSldStrMatchesFunctionFromFunctionFilter(t)},t.prototype.getSldComparisonFilterFromComparisonFilter=function(e){var r,n,o,i={},s=e[0],a=e[1],l=e[2],c=t.keysByValue(t.comparisonMap,s),u=c.length>1&&null===l?c[1]:c[0],p="PropertyName";return Array.isArray(a)&&a[0].startsWith("FN_")&&(a=this.getSldFunctionFilterFromFunctionFilter(a),p="Function"),i[u]="PropertyIsNull"===u?[(r={},r[p]=[a],r)]:"PropertyIsLike"===u?[(n={$:{wildCard:"*",singleChar:".",escape:"!"}},n[p]=[a],n.Literal=[l],n)]:[(o={},o[p]=[a],o.Literal=[l],o)],i},t.prototype.getSldFilterFromFilter=function(e){var r=this,n={},o=e[0],i=e.slice(1);if(Object.values(t.comparisonMap).includes(o))n=this.getSldComparisonFilterFromComparisonFilter(e);else if(Object.values(t.combinationMap).includes(o)){var s=t.keysByValue(t.combinationMap,o)[0];n[s]=[{}],i.forEach((function(t,e){var o=r.getSldFilterFromFilter(t),i=Object.keys(o)[0];if("||"===t[0]||"&&"===t[0]){["And","Or"].includes(i)?(n[s][0][i]||(n[s][0][i]=[]),n[s][0][i][e]={}):n[s][0][i]={};var a=Object.keys(o)[0];t.forEach((function(t,o){if(o>0){var i=r.getSldFilterFromFilter(t),l=Object.keys(i)[0];n[s][0][a][e]||(n[s][0][a][e]={}),n[s][0][a][e][l]||(n[s][0][a][e][l]=[]),n[s][0][a][e][l].push(i[l][0])}}))}else Array.isArray(n[s][0][i])?n[s][0][i].push(o[i][0]):n[s][0][i]=o[i]}))}else Object.values(t.negationOperatorMap).includes(o)&&(n.Not=i.map((function(t){return r.getSldFilterFromFilter(t)})));return n},t.title="SLD Style Parser",t.negationOperatorMap={Not:"!"},t.combinationMap={And:"&&",Or:"||",PropertyIsBetween:"&&"},t.comparisonMap={PropertyIsEqualTo:"==",PropertyIsNotEqualTo:"!=",PropertyIsLike:"*=",PropertyIsLessThan:"<",PropertyIsLessThanOrEqualTo:"<=",PropertyIsGreaterThan:">",PropertyIsGreaterThanOrEqualTo:">=",PropertyIsNull:"=="},t}();e.SldStyleParser=u,e.default=u},54830:function(t,e){(function(){"use strict";e.stripBOM=function(t){return"\ufeff"===t[0]?t.substring(1):t}}).call(this)},95984:function(t,e,r){(function(){"use strict";var t,n,o,i,s,a={}.hasOwnProperty;t=r(5532),n=r(26688).defaults,i=function(t){return"string"==typeof t&&(t.indexOf("&")>=0||t.indexOf(">")>=0||t.indexOf("<")>=0)},s=function(t){return"<![CDATA["+o(t)+"]]>"},o=function(t){return t.replace("]]>","]]]]><![CDATA[>")},e.Builder=function(){function e(t){var e,r,o;for(e in this.options={},r=n[.2])a.call(r,e)&&(o=r[e],this.options[e]=o);for(e in t)a.call(t,e)&&(o=t[e],this.options[e]=o)}return e.prototype.buildObject=function(e){var r,o,l,c,u,p;return r=this.options.attrkey,o=this.options.charkey,1===Object.keys(e).length&&this.options.rootName===n[.2].rootName?e=e[u=Object.keys(e)[0]]:u=this.options.rootName,p=this,l=function(t,e){var n,c,u,h,f,d;if("object"!=typeof e)p.options.cdata&&i(e)?t.raw(s(e)):t.txt(e);else if(Array.isArray(e)){for(h in e)if(a.call(e,h))for(f in c=e[h])u=c[f],t=l(t.ele(f),u).up()}else for(f in e)if(a.call(e,f))if(c=e[f],f===r){if("object"==typeof c)for(n in c)d=c[n],t=t.att(n,d)}else if(f===o)t=p.options.cdata&&i(c)?t.raw(s(c)):t.txt(c);else if(Array.isArray(c))for(h in c)a.call(c,h)&&(t="string"==typeof(u=c[h])?p.options.cdata&&i(u)?t.ele(f).raw(s(u)).up():t.ele(f,u).up():l(t.ele(f),u).up());else"object"==typeof c?t=l(t.ele(f),c).up():"string"==typeof c&&p.options.cdata&&i(c)?t=t.ele(f).raw(s(c)).up():(null==c&&(c=""),t=t.ele(f,c.toString()).up());return t},c=t.create(u,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),l(c,e).end(this.options.renderOpts)},e}()}).call(this)},26688:function(t,e){(function(){e.defaults={.1:{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},.2:{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:"\n"},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(this)},20118:function(t,e,r){(function(){"use strict";var t,n,o,i,s,a,l,c,u=function(t,e){return function(){return t.apply(e,arguments)}},p={}.hasOwnProperty;l=r(36099),o=r(17187),t=r(54830),a=r(86112),c=r(18698).setImmediate,n=r(26688).defaults,i=function(t){return"object"==typeof t&&null!=t&&0===Object.keys(t).length},s=function(t,e,r){var n,o;for(n=0,o=t.length;n<o;n++)e=(0,t[n])(e,r);return e},e.Parser=function(r){function o(t){var r,o,i;if(this.parseStringPromise=u(this.parseStringPromise,this),this.parseString=u(this.parseString,this),this.reset=u(this.reset,this),this.assignOrPush=u(this.assignOrPush,this),this.processAsync=u(this.processAsync,this),!(this instanceof e.Parser))return new e.Parser(t);for(r in this.options={},o=n[.2])p.call(o,r)&&(i=o[r],this.options[r]=i);for(r in t)p.call(t,r)&&(i=t[r],this.options[r]=i);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(a.normalize)),this.reset()}return function(t,e){for(var r in e)p.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(o,r),o.prototype.processAsync=function(){var t,e;try{return this.remaining.length<=this.options.chunkSize?(t=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(t),this.saxParser.close()):(t=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(t),c(this.processAsync))}catch(t){if(e=t,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(e)}},o.prototype.assignOrPush=function(t,e,r){return e in t?(t[e]instanceof Array||(t[e]=[t[e]]),t[e].push(r)):this.options.explicitArray?t[e]=[r]:t[e]=r},o.prototype.reset=function(){var t,e,r,n,o;return this.removeAllListeners(),this.saxParser=l.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=(o=this,function(t){if(o.saxParser.resume(),!o.saxParser.errThrown)return o.saxParser.errThrown=!0,o.emit("error",t)}),this.saxParser.onend=function(t){return function(){if(!t.saxParser.ended)return t.saxParser.ended=!0,t.emit("end",t.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,n=[],t=this.options.attrkey,e=this.options.charkey,this.saxParser.onopentag=function(r){return function(o){var i,a,l,c,u;if((l={})[e]="",!r.options.ignoreAttrs)for(i in u=o.attributes)p.call(u,i)&&(t in l||r.options.mergeAttrs||(l[t]={}),a=r.options.attrValueProcessors?s(r.options.attrValueProcessors,o.attributes[i],i):o.attributes[i],c=r.options.attrNameProcessors?s(r.options.attrNameProcessors,i):i,r.options.mergeAttrs?r.assignOrPush(l,c,a):l[t][c]=a);return l["#name"]=r.options.tagNameProcessors?s(r.options.tagNameProcessors,o.name):o.name,r.options.xmlns&&(l[r.options.xmlnskey]={uri:o.uri,local:o.local}),n.push(l)}}(this),this.saxParser.onclosetag=function(t){return function(){var r,o,a,l,c,u,h,f,d,y;if(u=n.pop(),c=u["#name"],t.options.explicitChildren&&t.options.preserveChildrenOrder||delete u["#name"],!0===u.cdata&&(r=u.cdata,delete u.cdata),d=n[n.length-1],u[e].match(/^\s*$/)&&!r?(o=u[e],delete u[e]):(t.options.trim&&(u[e]=u[e].trim()),t.options.normalize&&(u[e]=u[e].replace(/\s{2,}/g," ").trim()),u[e]=t.options.valueProcessors?s(t.options.valueProcessors,u[e],c):u[e],1===Object.keys(u).length&&e in u&&!t.EXPLICIT_CHARKEY&&(u=u[e])),i(u)&&(u=""!==t.options.emptyTag?t.options.emptyTag:o),null!=t.options.validator&&(y="/"+function(){var t,e,r;for(r=[],t=0,e=n.length;t<e;t++)l=n[t],r.push(l["#name"]);return r}().concat(c).join("/"),function(){var e;try{u=t.options.validator(y,d&&d[c],u)}catch(r){return e=r,t.emit("error",e)}}()),t.options.explicitChildren&&!t.options.mergeAttrs&&"object"==typeof u)if(t.options.preserveChildrenOrder){if(d){for(a in d[t.options.childkey]=d[t.options.childkey]||[],h={},u)p.call(u,a)&&(h[a]=u[a]);d[t.options.childkey].push(h),delete u["#name"],1===Object.keys(u).length&&e in u&&!t.EXPLICIT_CHARKEY&&(u=u[e])}}else l={},t.options.attrkey in u&&(l[t.options.attrkey]=u[t.options.attrkey],delete u[t.options.attrkey]),!t.options.charsAsChildren&&t.options.charkey in u&&(l[t.options.charkey]=u[t.options.charkey],delete u[t.options.charkey]),Object.getOwnPropertyNames(u).length>0&&(l[t.options.childkey]=u),u=l;return n.length>0?t.assignOrPush(d,c,u):(t.options.explicitRoot&&(f=u,(u={})[c]=f),t.resultObject=u,t.saxParser.ended=!0,t.emit("end",t.resultObject))}}(this),r=function(t){return function(r){var o,i;if(i=n[n.length-1])return i[e]+=r,t.options.explicitChildren&&t.options.preserveChildrenOrder&&t.options.charsAsChildren&&(t.options.includeWhiteChars||""!==r.replace(/\\n/g,"").trim())&&(i[t.options.childkey]=i[t.options.childkey]||[],(o={"#name":"__text__"})[e]=r,t.options.normalize&&(o[e]=o[e].replace(/\s{2,}/g," ").trim()),i[t.options.childkey].push(o)),i}}(this),this.saxParser.ontext=r,this.saxParser.oncdata=function(t){var e;if(e=r(t))return e.cdata=!0}},o.prototype.parseString=function(e,r){var n;null!=r&&"function"==typeof r&&(this.on("end",(function(t){return this.reset(),r(null,t)})),this.on("error",(function(t){return this.reset(),r(t)})));try{return""===(e=e.toString()).trim()?(this.emit("end",null),!0):(e=t.stripBOM(e),this.options.async?(this.remaining=e,c(this.processAsync),this.saxParser):this.saxParser.write(e).close())}catch(t){if(n=t,!this.saxParser.errThrown&&!this.saxParser.ended)return this.emit("error",n),this.saxParser.errThrown=!0;if(this.saxParser.ended)throw n}},o.prototype.parseStringPromise=function(t){return new Promise((e=this,function(r,n){return e.parseString(t,(function(t,e){return t?n(t):r(e)}))}));var e},o}(o),e.parseString=function(t,r,n){var o,i;return null!=n?("function"==typeof n&&(o=n),"object"==typeof r&&(i=r)):("function"==typeof r&&(o=r),i={}),new e.Parser(i).parseString(t,o)},e.parseStringPromise=function(t,r){var n;return"object"==typeof r&&(n=r),new e.Parser(n).parseStringPromise(t)}}).call(this)},86112:function(t,e){(function(){"use strict";var t;t=new RegExp(/(?!xmlns)^.*:/),e.normalize=function(t){return t.toLowerCase()},e.firstCharLowerCase=function(t){return t.charAt(0).toLowerCase()+t.slice(1)},e.stripPrefix=function(e){return e.replace(t,"")},e.parseNumbers=function(t){return isNaN(t)||(t=t%1==0?parseInt(t,10):parseFloat(t)),t},e.parseBooleans=function(t){return/^(?:true|false)$/i.test(t)&&(t="true"===t.toLowerCase()),t}}).call(this)},87970:function(t,e,r){(function(){"use strict";var t,n,o,i,s={}.hasOwnProperty;n=r(26688),t=r(95984),o=r(20118),i=r(86112),e.defaults=n.defaults,e.processors=i,e.ValidationError=function(t){function e(t){this.message=t}return function(t,e){for(var r in e)s.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,Error),e}(),e.Builder=t.Builder,e.Parser=o.Parser,e.parseString=o.parseString,e.parseStringPromise=o.parseStringPromise}).call(this)},17557:function(t){(function(){t.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(this)},39335:function(t){(function(){t.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(this)},78369:function(t){(function(){var e,r,n,o,i,s,a,l=[].slice,c={}.hasOwnProperty;e=function(){var t,e,r,n,o,s;if(s=arguments[0],o=2<=arguments.length?l.call(arguments,1):[],i(Object.assign))Object.assign.apply(null,arguments);else for(t=0,r=o.length;t<r;t++)if(null!=(n=o[t]))for(e in n)c.call(n,e)&&(s[e]=n[e]);return s},i=function(t){return!!t&&"[object Function]"===Object.prototype.toString.call(t)},s=function(t){var e;return!!t&&("function"==(e=typeof t)||"object"===e)},n=function(t){return i(Array.isArray)?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)},o=function(t){var e;if(n(t))return!t.length;for(e in t)if(c.call(t,e))return!1;return!0},a=function(t){var e,r;return s(t)&&(r=Object.getPrototypeOf(t))&&(e=r.constructor)&&"function"==typeof e&&e instanceof e&&Function.prototype.toString.call(e)===Function.prototype.toString.call(Object)},r=function(t){return i(t.valueOf)?t.valueOf():t},t.exports.assign=e,t.exports.isFunction=i,t.exports.isObject=s,t.exports.isArray=n,t.exports.isEmpty=o,t.exports.isPlainObject=a,t.exports.getValue=r}).call(this)},30594:function(t){(function(){t.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(this)},72750:function(t,e,r){(function(){var e;e=r(39335),r(32026),t.exports=function(){function t(t,r,n){if(this.parent=t,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),null==r)throw new Error("Missing attribute name. "+this.debugInfo(r));this.name=this.stringify.name(r),this.value=this.stringify.attValue(n),this.type=e.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(t.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(t.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(t.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(t.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(t.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(t.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"specified",{get:function(){return!0}}),t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(t){return this.options.writer.attribute(this,this.options.writer.filterOptions(t))},t.prototype.debugInfo=function(t){return null==(t=t||this.name)?"parent: <"+this.parent.name+">":"attribute: {"+t+"}, parent: <"+this.parent.name+">"},t.prototype.isEqualNode=function(t){return t.namespaceURI===this.namespaceURI&&t.prefix===this.prefix&&t.localName===this.localName&&t.value===this.value},t}()}).call(this)},66170:function(t,e,r){(function(){var e,n,o={}.hasOwnProperty;e=r(39335),n=r(6488),t.exports=function(t){function r(t,n){if(r.__super__.constructor.call(this,t),null==n)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=e.CData,this.value=this.stringify.cdata(n)}return function(t,e){for(var r in e)o.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(r,t),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(t){return this.options.writer.cdata(this,this.options.writer.filterOptions(t))},r}(n)}).call(this)},6488:function(t,e,r){(function(){var e,n={}.hasOwnProperty;e=r(32026),t.exports=function(t){function e(t){e.__super__.constructor.call(this,t),this.value=""}return function(t,e){for(var r in e)n.call(e,r)&&(t[r]=e[r]);function o(){this.constructor=t}o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype}(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(e.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(e.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),e.prototype.clone=function(){return Object.create(this)},e.prototype.substringData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.appendData=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.insertData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.deleteData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.replaceData=function(t,e,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.isEqualNode=function(t){return!!e.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&t.data===this.data},e}(e)}).call(this)},62096:function(t,e,r){(function(){var e,n,o={}.hasOwnProperty;e=r(39335),n=r(6488),t.exports=function(t){function r(t,n){if(r.__super__.constructor.call(this,t),null==n)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=e.Comment,this.value=this.stringify.comment(n)}return function(t,e){for(var r in e)o.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(r,t),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(t){return this.options.writer.comment(this,this.options.writer.filterOptions(t))},r}(n)}).call(this)},30383:function(t,e,r){(function(){var e,n;e=r(93933),n=r(66210),t.exports=function(){function t(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new e,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}return Object.defineProperty(t.prototype,"parameterNames",{get:function(){return new n(Object.keys(this.defaultParams))}}),t.prototype.getParameter=function(t){return this.params.hasOwnProperty(t)?this.params[t]:null},t.prototype.canSetParameter=function(t,e){return!0},t.prototype.setParameter=function(t,e){return null!=e?this.params[t]=e:delete this.params[t]},t}()}).call(this)},93933:function(t){(function(){t.exports=function(){function t(){}return t.prototype.handleError=function(t){throw new Error(t)},t}()}).call(this)},91770:function(t){(function(){t.exports=function(){function t(){}return t.prototype.hasFeature=function(t,e){return!0},t.prototype.createDocumentType=function(t,e,r){throw new Error("This DOM method is not implemented.")},t.prototype.createDocument=function(t,e,r){throw new Error("This DOM method is not implemented.")},t.prototype.createHTMLDocument=function(t){throw new Error("This DOM method is not implemented.")},t.prototype.getFeature=function(t,e){throw new Error("This DOM method is not implemented.")},t}()}).call(this)},66210:function(t){(function(){t.exports=function(){function t(t){this.arr=t||[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this.arr.length}}),t.prototype.item=function(t){return this.arr[t]||null},t.prototype.contains=function(t){return-1!==this.arr.indexOf(t)},t}()}).call(this)},51179:function(t,e,r){(function(){var e,n,o={}.hasOwnProperty;n=r(32026),e=r(39335),t.exports=function(t){function r(t,n,o,i,s,a){if(r.__super__.constructor.call(this,t),null==n)throw new Error("Missing DTD element name. "+this.debugInfo());if(null==o)throw new Error("Missing DTD attribute name. "+this.debugInfo(n));if(!i)throw new Error("Missing DTD attribute type. "+this.debugInfo(n));if(!s)throw new Error("Missing DTD attribute default. "+this.debugInfo(n));if(0!==s.indexOf("#")&&(s="#"+s),!s.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(n));if(a&&!s.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(n));this.elementName=this.stringify.name(n),this.type=e.AttributeDeclaration,this.attributeName=this.stringify.name(o),this.attributeType=this.stringify.dtdAttType(i),a&&(this.defaultValue=this.stringify.dtdAttDefault(a)),this.defaultValueType=s}return function(t,e){for(var r in e)o.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(r,t),r.prototype.toString=function(t){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(t))},r}(n)}).call(this)},36347:function(t,e,r){(function(){var e,n,o={}.hasOwnProperty;n=r(32026),e=r(39335),t.exports=function(t){function r(t,n,o){if(r.__super__.constructor.call(this,t),null==n)throw new Error("Missing DTD element name. "+this.debugInfo());o||(o="(#PCDATA)"),Array.isArray(o)&&(o="("+o.join(",")+")"),this.name=this.stringify.name(n),this.type=e.ElementDeclaration,this.value=this.stringify.dtdElementValue(o)}return function(t,e){for(var r in e)o.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(r,t),r.prototype.toString=function(t){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(t))},r}(n)}).call(this)},99078:function(t,e,r){(function(){var e,n,o,i={}.hasOwnProperty;o=r(78369).isObject,n=r(32026),e=r(39335),t.exports=function(t){function r(t,n,i,s){if(r.__super__.constructor.call(this,t),null==i)throw new Error("Missing DTD entity name. "+this.debugInfo(i));if(null==s)throw new Error("Missing DTD entity value. "+this.debugInfo(i));if(this.pe=!!n,this.name=this.stringify.name(i),this.type=e.EntityDeclaration,o(s)){if(!s.pubID&&!s.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(i));if(s.pubID&&!s.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(i));if(this.internal=!1,null!=s.pubID&&(this.pubID=this.stringify.dtdPubID(s.pubID)),null!=s.sysID&&(this.sysID=this.stringify.dtdSysID(s.sysID)),null!=s.nData&&(this.nData=this.stringify.dtdNData(s.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(i))}else this.value=this.stringify.dtdEntityValue(s),this.internal=!0}return function(t,e){for(var r in e)i.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(r,t),Object.defineProperty(r.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(r.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(r.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(r.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"xmlVersion",{get:function(){return null}}),r.prototype.toString=function(t){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(t))},r}(n)}).call(this)},44777:function(t,e,r){(function(){var e,n,o={}.hasOwnProperty;n=r(32026),e=r(39335),t.exports=function(t){function r(t,n,o){if(r.__super__.constructor.call(this,t),null==n)throw new Error("Missing DTD notation name. "+this.debugInfo(n));if(!o.pubID&&!o.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(n));this.name=this.stringify.name(n),this.type=e.NotationDeclaration,null!=o.pubID&&(this.pubID=this.stringify.dtdPubID(o.pubID)),null!=o.sysID&&(this.sysID=this.stringify.dtdSysID(o.sysID))}return function(t,e){for(var r in e)o.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(r,t),Object.defineProperty(r.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(r.prototype,"systemId",{get:function(){return this.sysID}}),r.prototype.toString=function(t){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(t))},r}(n)}).call(this)},59077:function(t,e,r){(function(){var e,n,o,i={}.hasOwnProperty;o=r(78369).isObject,n=r(32026),e=r(39335),t.exports=function(t){function r(t,n,i,s){var a;r.__super__.constructor.call(this,t),o(n)&&(n=(a=n).version,i=a.encoding,s=a.standalone),n||(n="1.0"),this.type=e.Declaration,this.version=this.stringify.xmlVersion(n),null!=i&&(this.encoding=this.stringify.xmlEncoding(i)),null!=s&&(this.standalone=this.stringify.xmlStandalone(s))}return function(t,e){for(var r in e)i.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(r,t),r.prototype.toString=function(t){return this.options.writer.declaration(this,this.options.writer.filterOptions(t))},r}(n)}).call(this)},86544:function(t,e,r){(function(){var e,n,o,i,s,a,l,c,u={}.hasOwnProperty;c=r(78369).isObject,l=r(32026),e=r(39335),n=r(51179),i=r(99078),o=r(36347),s=r(44777),a=r(40663),t.exports=function(t){function r(t,n,o){var i,s,a,l,u,p;if(r.__super__.constructor.call(this,t),this.type=e.DocType,t.children)for(s=0,a=(l=t.children).length;s<a;s++)if((i=l[s]).type===e.Element){this.name=i.name;break}this.documentObject=t,c(n)&&(n=(u=n).pubID,o=u.sysID),null==o&&(o=(p=[n,o])[0],n=p[1]),null!=n&&(this.pubID=this.stringify.dtdPubID(n)),null!=o&&(this.sysID=this.stringify.dtdSysID(o))}return function(t,e){for(var r in e)u.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(r,t),Object.defineProperty(r.prototype,"entities",{get:function(){var t,r,n,o,i;for(o={},r=0,n=(i=this.children).length;r<n;r++)(t=i[r]).type!==e.EntityDeclaration||t.pe||(o[t.name]=t);return new a(o)}}),Object.defineProperty(r.prototype,"notations",{get:function(){var t,r,n,o,i;for(o={},r=0,n=(i=this.children).length;r<n;r++)(t=i[r]).type===e.NotationDeclaration&&(o[t.name]=t);return new a(o)}}),Object.defineProperty(r.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(r.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(r.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),r.prototype.element=function(t,e){var r;return r=new o(this,t,e),this.children.push(r),this},r.prototype.attList=function(t,e,r,o,i){var s;return s=new n(this,t,e,r,o,i),this.children.push(s),this},r.prototype.entity=function(t,e){var r;return r=new i(this,!1,t,e),this.children.push(r),this},r.prototype.pEntity=function(t,e){var r;return r=new i(this,!0,t,e),this.children.push(r),this},r.prototype.notation=function(t,e){var r;return r=new s(this,t,e),this.children.push(r),this},r.prototype.toString=function(t){return this.options.writer.docType(this,this.options.writer.filterOptions(t))},r.prototype.ele=function(t,e){return this.element(t,e)},r.prototype.att=function(t,e,r,n,o){return this.attList(t,e,r,n,o)},r.prototype.ent=function(t,e){return this.entity(t,e)},r.prototype.pent=function(t,e){return this.pEntity(t,e)},r.prototype.not=function(t,e){return this.notation(t,e)},r.prototype.up=function(){return this.root()||this.documentObject},r.prototype.isEqualNode=function(t){return!!r.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&t.name===this.name&&t.publicId===this.publicId&&t.systemId===this.systemId},r}(l)}).call(this)},66934:function(t,e,r){(function(){var e,n,o,i,s,a,l,c={}.hasOwnProperty;l=r(78369).isPlainObject,o=r(91770),n=r(30383),i=r(32026),e=r(39335),a=r(95549),s=r(26434),t.exports=function(t){function r(t){r.__super__.constructor.call(this,null),this.name="#document",this.type=e.Document,this.documentURI=null,this.domConfig=new n,t||(t={}),t.writer||(t.writer=new s),this.options=t,this.stringify=new a(t)}return function(t,e){for(var r in e)c.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(r,t),Object.defineProperty(r.prototype,"implementation",{value:new o}),Object.defineProperty(r.prototype,"doctype",{get:function(){var t,r,n,o;for(r=0,n=(o=this.children).length;r<n;r++)if((t=o[r]).type===e.DocType)return t;return null}}),Object.defineProperty(r.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(r.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(r.prototype,"xmlEncoding",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration?this.children[0].encoding:null}}),Object.defineProperty(r.prototype,"xmlStandalone",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration&&"yes"===this.children[0].standalone}}),Object.defineProperty(r.prototype,"xmlVersion",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(r.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(r.prototype,"origin",{get:function(){return null}}),Object.defineProperty(r.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(r.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(r.prototype,"contentType",{get:function(){return null}}),r.prototype.end=function(t){var e;return e={},t?l(t)&&(e=t,t=this.options.writer):t=this.options.writer,t.document(this,t.filterOptions(e))},r.prototype.toString=function(t){return this.options.writer.document(this,this.options.writer.filterOptions(t))},r.prototype.createElement=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createTextNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createComment=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createCDATASection=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createProcessingInstruction=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createAttribute=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createEntityReference=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.importNode=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createElementNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementById=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.adoptNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.renameNode=function(t,e,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByClassName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createEvent=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createNodeIterator=function(t,e,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createTreeWalker=function(t,e,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r}(i)}).call(this)},79227:function(t,e,r){(function(){var e,n,o,i,s,a,l,c,u,p,h,f,d,y,m,g,v,b,w,S,x,E,O,F={}.hasOwnProperty;O=r(78369),x=O.isObject,S=O.isFunction,E=O.isPlainObject,w=O.getValue,e=r(39335),f=r(66934),d=r(32161),i=r(66170),s=r(62096),m=r(79406),b=r(43595),y=r(19181),p=r(59077),h=r(86544),a=r(51179),c=r(99078),l=r(36347),u=r(44777),o=r(72750),v=r(95549),g=r(26434),n=r(30594),t.exports=function(){function t(t,r,n){var o;this.name="?xml",this.type=e.Document,t||(t={}),o={},t.writer?E(t.writer)&&(o=t.writer,t.writer=new g):t.writer=new g,this.options=t,this.writer=t.writer,this.writerOptions=this.writer.filterOptions(o),this.stringify=new v(t),this.onDataCallback=r||function(){},this.onEndCallback=n||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return t.prototype.createChildNode=function(t){var r,n,o,i,s,a,l,c;switch(t.type){case e.CData:this.cdata(t.value);break;case e.Comment:this.comment(t.value);break;case e.Element:for(n in o={},l=t.attribs)F.call(l,n)&&(r=l[n],o[n]=r.value);this.node(t.name,o);break;case e.Dummy:this.dummy();break;case e.Raw:this.raw(t.value);break;case e.Text:this.text(t.value);break;case e.ProcessingInstruction:this.instruction(t.target,t.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+t.constructor.name)}for(s=0,a=(c=t.children).length;s<a;s++)i=c[s],this.createChildNode(i),i.type===e.Element&&this.up();return this},t.prototype.dummy=function(){return this},t.prototype.node=function(t,e,r){var n;if(null==t)throw new Error("Missing node name.");if(this.root&&-1===this.currentLevel)throw new Error("Document can only have one root node. "+this.debugInfo(t));return this.openCurrent(),t=w(t),null==e&&(e={}),e=w(e),x(e)||(r=(n=[e,r])[0],e=n[1]),this.currentNode=new d(this,t,e),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,null!=r&&this.text(r),this},t.prototype.element=function(t,r,n){var o,i,s,a,l,c;if(this.currentNode&&this.currentNode.type===e.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(t)||x(t)||S(t))for(a=this.options.noValidation,this.options.noValidation=!0,(c=new f(this.options).element("TEMP_ROOT")).element(t),this.options.noValidation=a,i=0,s=(l=c.children).length;i<s;i++)o=l[i],this.createChildNode(o),o.type===e.Element&&this.up();else this.node(t,r,n);return this},t.prototype.attribute=function(t,e){var r,n;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(t));if(null!=t&&(t=w(t)),x(t))for(r in t)F.call(t,r)&&(n=t[r],this.attribute(r,n));else S(e)&&(e=e.apply()),this.options.keepNullAttributes&&null==e?this.currentNode.attribs[t]=new o(this,t,""):null!=e&&(this.currentNode.attribs[t]=new o(this,t,e));return this},t.prototype.text=function(t){var e;return this.openCurrent(),e=new b(this,t),this.onData(this.writer.text(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.cdata=function(t){var e;return this.openCurrent(),e=new i(this,t),this.onData(this.writer.cdata(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.comment=function(t){var e;return this.openCurrent(),e=new s(this,t),this.onData(this.writer.comment(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.raw=function(t){var e;return this.openCurrent(),e=new m(this,t),this.onData(this.writer.raw(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.instruction=function(t,e){var r,n,o,i,s;if(this.openCurrent(),null!=t&&(t=w(t)),null!=e&&(e=w(e)),Array.isArray(t))for(r=0,i=t.length;r<i;r++)n=t[r],this.instruction(n);else if(x(t))for(n in t)F.call(t,n)&&(o=t[n],this.instruction(n,o));else S(e)&&(e=e.apply()),s=new y(this,t,e),this.onData(this.writer.processingInstruction(s,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},t.prototype.declaration=function(t,e,r){var n;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return n=new p(this,t,e,r),this.onData(this.writer.declaration(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.doctype=function(t,e,r){if(this.openCurrent(),null==t)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new h(this,e,r),this.currentNode.rootNodeName=t,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},t.prototype.dtdElement=function(t,e){var r;return this.openCurrent(),r=new l(this,t,e),this.onData(this.writer.dtdElement(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.attList=function(t,e,r,n,o){var i;return this.openCurrent(),i=new a(this,t,e,r,n,o),this.onData(this.writer.dtdAttList(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.entity=function(t,e){var r;return this.openCurrent(),r=new c(this,!1,t,e),this.onData(this.writer.dtdEntity(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.pEntity=function(t,e){var r;return this.openCurrent(),r=new c(this,!0,t,e),this.onData(this.writer.dtdEntity(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.notation=function(t,e){var r;return this.openCurrent(),r=new u(this,t,e),this.onData(this.writer.dtdNotation(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},t.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},t.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},t.prototype.openNode=function(t){var r,o,i,s;if(!t.isOpen){if(this.root||0!==this.currentLevel||t.type!==e.Element||(this.root=t),o="",t.type===e.Element){for(i in this.writerOptions.state=n.OpenTag,o=this.writer.indent(t,this.writerOptions,this.currentLevel)+"<"+t.name,s=t.attribs)F.call(s,i)&&(r=s[i],o+=this.writer.attribute(r,this.writerOptions,this.currentLevel));o+=(t.children?">":"/>")+this.writer.endline(t,this.writerOptions,this.currentLevel),this.writerOptions.state=n.InsideTag}else this.writerOptions.state=n.OpenTag,o=this.writer.indent(t,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+t.rootNodeName,t.pubID&&t.sysID?o+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(o+=' SYSTEM "'+t.sysID+'"'),t.children?(o+=" [",this.writerOptions.state=n.InsideTag):(this.writerOptions.state=n.CloseTag,o+=">"),o+=this.writer.endline(t,this.writerOptions,this.currentLevel);return this.onData(o,this.currentLevel),t.isOpen=!0}},t.prototype.closeNode=function(t){var r;if(!t.isClosed)return"",this.writerOptions.state=n.CloseTag,r=t.type===e.Element?this.writer.indent(t,this.writerOptions,this.currentLevel)+"</"+t.name+">"+this.writer.endline(t,this.writerOptions,this.currentLevel):this.writer.indent(t,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(t,this.writerOptions,this.currentLevel),this.writerOptions.state=n.None,this.onData(r,this.currentLevel),t.isClosed=!0},t.prototype.onData=function(t,e){return this.documentStarted=!0,this.onDataCallback(t,e+1)},t.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},t.prototype.debugInfo=function(t){return null==t?"":"node: <"+t+">"},t.prototype.ele=function(){return this.element.apply(this,arguments)},t.prototype.nod=function(t,e,r){return this.node(t,e,r)},t.prototype.txt=function(t){return this.text(t)},t.prototype.dat=function(t){return this.cdata(t)},t.prototype.com=function(t){return this.comment(t)},t.prototype.ins=function(t,e){return this.instruction(t,e)},t.prototype.dec=function(t,e,r){return this.declaration(t,e,r)},t.prototype.dtd=function(t,e,r){return this.doctype(t,e,r)},t.prototype.e=function(t,e,r){return this.element(t,e,r)},t.prototype.n=function(t,e,r){return this.node(t,e,r)},t.prototype.t=function(t){return this.text(t)},t.prototype.d=function(t){return this.cdata(t)},t.prototype.c=function(t){return this.comment(t)},t.prototype.r=function(t){return this.raw(t)},t.prototype.i=function(t,e){return this.instruction(t,e)},t.prototype.att=function(){return this.currentNode&&this.currentNode.type===e.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},t.prototype.a=function(){return this.currentNode&&this.currentNode.type===e.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},t.prototype.ent=function(t,e){return this.entity(t,e)},t.prototype.pent=function(t,e){return this.pEntity(t,e)},t.prototype.not=function(t,e){return this.notation(t,e)},t}()}).call(this)},78833:function(t,e,r){(function(){var e,n,o={}.hasOwnProperty;n=r(32026),e=r(39335),t.exports=function(t){function r(t){r.__super__.constructor.call(this,t),this.type=e.Dummy}return function(t,e){for(var r in e)o.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(r,t),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(t){return""},r}(n)}).call(this)},32161:function(t,e,r){(function(){var e,n,o,i,s,a,l,c,u={}.hasOwnProperty;c=r(78369),l=c.isObject,a=c.isFunction,s=c.getValue,i=r(32026),e=r(39335),n=r(72750),o=r(40663),t.exports=function(t){function r(t,n,o){var i,s,a,l;if(r.__super__.constructor.call(this,t),null==n)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(n),this.type=e.Element,this.attribs={},this.schemaTypeInfo=null,null!=o&&this.attribute(o),t.type===e.Document&&(this.isRoot=!0,this.documentObject=t,t.rootObject=this,t.children))for(s=0,a=(l=t.children).length;s<a;s++)if((i=l[s]).type===e.DocType){i.name=this.name;break}}return function(t,e){for(var r in e)u.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(r,t),Object.defineProperty(r.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(r.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(r.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(r.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(r.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"attributes",{get:function(){return this.attributeMap&&this.attributeMap.nodes||(this.attributeMap=new o(this.attribs)),this.attributeMap}}),r.prototype.clone=function(){var t,e,r,n;for(e in(r=Object.create(this)).isRoot&&(r.documentObject=null),r.attribs={},n=this.attribs)u.call(n,e)&&(t=n[e],r.attribs[e]=t.clone());return r.children=[],this.children.forEach((function(t){var e;return(e=t.clone()).parent=r,r.children.push(e)})),r},r.prototype.attribute=function(t,e){var r,o;if(null!=t&&(t=s(t)),l(t))for(r in t)u.call(t,r)&&(o=t[r],this.attribute(r,o));else a(e)&&(e=e.apply()),this.options.keepNullAttributes&&null==e?this.attribs[t]=new n(this,t,""):null!=e&&(this.attribs[t]=new n(this,t,e));return this},r.prototype.removeAttribute=function(t){var e,r,n;if(null==t)throw new Error("Missing attribute name. "+this.debugInfo());if(t=s(t),Array.isArray(t))for(r=0,n=t.length;r<n;r++)e=t[r],delete this.attribs[e];else delete this.attribs[t];return this},r.prototype.toString=function(t){return this.options.writer.element(this,this.options.writer.filterOptions(t))},r.prototype.att=function(t,e){return this.attribute(t,e)},r.prototype.a=function(t,e){return this.attribute(t,e)},r.prototype.getAttribute=function(t){return this.attribs.hasOwnProperty(t)?this.attribs[t].value:null},r.prototype.setAttribute=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getAttributeNode=function(t){return this.attribs.hasOwnProperty(t)?this.attribs[t]:null},r.prototype.setAttributeNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.removeAttributeNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setAttributeNS=function(t,e,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.removeAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getAttributeNodeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setAttributeNodeNS=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.hasAttribute=function(t){return this.attribs.hasOwnProperty(t)},r.prototype.hasAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setIdAttribute=function(t,e){return this.attribs.hasOwnProperty(t)?this.attribs[t].isId:e},r.prototype.setIdAttributeNS=function(t,e,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setIdAttributeNode=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByClassName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.isEqualNode=function(t){var e,n,o;if(!r.__super__.isEqualNode.apply(this,arguments).isEqualNode(t))return!1;if(t.namespaceURI!==this.namespaceURI)return!1;if(t.prefix!==this.prefix)return!1;if(t.localName!==this.localName)return!1;if(t.attribs.length!==this.attribs.length)return!1;for(e=n=0,o=this.attribs.length-1;0<=o?n<=o:n>=o;e=0<=o?++n:--n)if(!this.attribs[e].isEqualNode(t.attribs[e]))return!1;return!0},r}(i)}).call(this)},40663:function(t){(function(){t.exports=function(){function t(t){this.nodes=t}return Object.defineProperty(t.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.getNamedItem=function(t){return this.nodes[t]},t.prototype.setNamedItem=function(t){var e;return e=this.nodes[t.nodeName],this.nodes[t.nodeName]=t,e||null},t.prototype.removeNamedItem=function(t){var e;return e=this.nodes[t],delete this.nodes[t],e||null},t.prototype.item=function(t){return this.nodes[Object.keys(this.nodes)[t]]||null},t.prototype.getNamedItemNS=function(t,e){throw new Error("This DOM method is not implemented.")},t.prototype.setNamedItemNS=function(t){throw new Error("This DOM method is not implemented.")},t.prototype.removeNamedItemNS=function(t,e){throw new Error("This DOM method is not implemented.")},t}()}).call(this)},32026:function(t,e,r){(function(){var e,n,o,i,s,a,l,c,u,p,h,f,d,y,m,g,v,b={}.hasOwnProperty;v=r(78369),g=v.isObject,m=v.isFunction,y=v.isEmpty,d=v.getValue,c=null,o=null,i=null,s=null,a=null,h=null,f=null,p=null,l=null,n=null,u=null,e=null,t.exports=function(){function t(t){this.parent=t,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,c||(c=r(32161),o=r(66170),i=r(62096),s=r(59077),a=r(86544),h=r(79406),f=r(43595),p=r(19181),l=r(78833),n=r(39335),u=r(82390),r(40663),e=r(17557))}return Object.defineProperty(t.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(t.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(t.prototype,"childNodes",{get:function(){return this.childNodeList&&this.childNodeList.nodes||(this.childNodeList=new u(this.children)),this.childNodeList}}),Object.defineProperty(t.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(t.prototype,"previousSibling",{get:function(){var t;return t=this.parent.children.indexOf(this),this.parent.children[t-1]||null}}),Object.defineProperty(t.prototype,"nextSibling",{get:function(){var t;return t=this.parent.children.indexOf(this),this.parent.children[t+1]||null}}),Object.defineProperty(t.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(t.prototype,"textContent",{get:function(){var t,e,r,o,i;if(this.nodeType===n.Element||this.nodeType===n.DocumentFragment){for(i="",e=0,r=(o=this.children).length;e<r;e++)(t=o[e]).textContent&&(i+=t.textContent);return i}return null},set:function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),t.prototype.setParent=function(t){var e,r,n,o,i;for(this.parent=t,t&&(this.options=t.options,this.stringify=t.stringify),i=[],r=0,n=(o=this.children).length;r<n;r++)e=o[r],i.push(e.setParent(this));return i},t.prototype.element=function(t,e,r){var n,o,i,s,a,l,c,u,p,h,f;if(l=null,null===e&&null==r&&(e=(p=[{},null])[0],r=p[1]),null==e&&(e={}),e=d(e),g(e)||(r=(h=[e,r])[0],e=h[1]),null!=t&&(t=d(t)),Array.isArray(t))for(i=0,c=t.length;i<c;i++)o=t[i],l=this.element(o);else if(m(t))l=this.element(t.apply());else if(g(t)){for(a in t)if(b.call(t,a))if(f=t[a],m(f)&&(f=f.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===a.indexOf(this.stringify.convertAttKey))l=this.attribute(a.substr(this.stringify.convertAttKey.length),f);else if(!this.options.separateArrayItems&&Array.isArray(f)&&y(f))l=this.dummy();else if(g(f)&&y(f))l=this.element(a);else if(this.options.keepNullNodes||null!=f)if(!this.options.separateArrayItems&&Array.isArray(f))for(s=0,u=f.length;s<u;s++)o=f[s],(n={})[a]=o,l=this.element(n);else g(f)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===a.indexOf(this.stringify.convertTextKey)?l=this.element(f):(l=this.element(a)).element(f):l=this.element(a,f);else l=this.dummy()}else l=this.options.keepNullNodes||null!==r?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===t.indexOf(this.stringify.convertTextKey)?this.text(r):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===t.indexOf(this.stringify.convertCDataKey)?this.cdata(r):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===t.indexOf(this.stringify.convertCommentKey)?this.comment(r):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===t.indexOf(this.stringify.convertRawKey)?this.raw(r):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===t.indexOf(this.stringify.convertPIKey)?this.instruction(t.substr(this.stringify.convertPIKey.length),r):this.node(t,e,r):this.dummy();if(null==l)throw new Error("Could not create any elements with: "+t+". "+this.debugInfo());return l},t.prototype.insertBefore=function(t,e,r){var n,o,i,s,a;if(null!=t?t.type:void 0)return s=e,(i=t).setParent(this),s?(o=children.indexOf(s),a=children.splice(o),children.push(i),Array.prototype.push.apply(children,a)):children.push(i),i;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(t));return o=this.parent.children.indexOf(this),a=this.parent.children.splice(o),n=this.parent.element(t,e,r),Array.prototype.push.apply(this.parent.children,a),n},t.prototype.insertAfter=function(t,e,r){var n,o,i;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(t));return o=this.parent.children.indexOf(this),i=this.parent.children.splice(o+1),n=this.parent.element(t,e,r),Array.prototype.push.apply(this.parent.children,i),n},t.prototype.remove=function(){var t;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return t=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[t,t-t+1].concat([])),this.parent},t.prototype.node=function(t,e,r){var n,o;return null!=t&&(t=d(t)),e||(e={}),e=d(e),g(e)||(r=(o=[e,r])[0],e=o[1]),n=new c(this,t,e),null!=r&&n.text(r),this.children.push(n),n},t.prototype.text=function(t){var e;return g(t)&&this.element(t),e=new f(this,t),this.children.push(e),this},t.prototype.cdata=function(t){var e;return e=new o(this,t),this.children.push(e),this},t.prototype.comment=function(t){var e;return e=new i(this,t),this.children.push(e),this},t.prototype.commentBefore=function(t){var e,r;return e=this.parent.children.indexOf(this),r=this.parent.children.splice(e),this.parent.comment(t),Array.prototype.push.apply(this.parent.children,r),this},t.prototype.commentAfter=function(t){var e,r;return e=this.parent.children.indexOf(this),r=this.parent.children.splice(e+1),this.parent.comment(t),Array.prototype.push.apply(this.parent.children,r),this},t.prototype.raw=function(t){var e;return e=new h(this,t),this.children.push(e),this},t.prototype.dummy=function(){return new l(this)},t.prototype.instruction=function(t,e){var r,n,o,i,s;if(null!=t&&(t=d(t)),null!=e&&(e=d(e)),Array.isArray(t))for(i=0,s=t.length;i<s;i++)r=t[i],this.instruction(r);else if(g(t))for(r in t)b.call(t,r)&&(n=t[r],this.instruction(r,n));else m(e)&&(e=e.apply()),o=new p(this,t,e),this.children.push(o);return this},t.prototype.instructionBefore=function(t,e){var r,n;return r=this.parent.children.indexOf(this),n=this.parent.children.splice(r),this.parent.instruction(t,e),Array.prototype.push.apply(this.parent.children,n),this},t.prototype.instructionAfter=function(t,e){var r,n;return r=this.parent.children.indexOf(this),n=this.parent.children.splice(r+1),this.parent.instruction(t,e),Array.prototype.push.apply(this.parent.children,n),this},t.prototype.declaration=function(t,e,r){var o,i;return o=this.document(),i=new s(o,t,e,r),0===o.children.length?o.children.unshift(i):o.children[0].type===n.Declaration?o.children[0]=i:o.children.unshift(i),o.root()||o},t.prototype.dtd=function(t,e){var r,o,i,s,l,c,u,p,h;for(r=this.document(),o=new a(r,t,e),i=s=0,c=(p=r.children).length;s<c;i=++s)if(p[i].type===n.DocType)return r.children[i]=o,o;for(i=l=0,u=(h=r.children).length;l<u;i=++l)if(h[i].isRoot)return r.children.splice(i,0,o),o;return r.children.push(o),o},t.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},t.prototype.root=function(){var t;for(t=this;t;){if(t.type===n.Document)return t.rootObject;if(t.isRoot)return t;t=t.parent}},t.prototype.document=function(){var t;for(t=this;t;){if(t.type===n.Document)return t;t=t.parent}},t.prototype.end=function(t){return this.document().end(t)},t.prototype.prev=function(){var t;if((t=this.parent.children.indexOf(this))<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[t-1]},t.prototype.next=function(){var t;if(-1===(t=this.parent.children.indexOf(this))||t===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[t+1]},t.prototype.importDocument=function(t){var e;return(e=t.root().clone()).parent=this,e.isRoot=!1,this.children.push(e),this},t.prototype.debugInfo=function(t){var e,r;return null!=(t=t||this.name)||(null!=(e=this.parent)?e.name:void 0)?null==t?"parent: <"+this.parent.name+">":(null!=(r=this.parent)?r.name:void 0)?"node: <"+t+">, parent: <"+this.parent.name+">":"node: <"+t+">":""},t.prototype.ele=function(t,e,r){return this.element(t,e,r)},t.prototype.nod=function(t,e,r){return this.node(t,e,r)},t.prototype.txt=function(t){return this.text(t)},t.prototype.dat=function(t){return this.cdata(t)},t.prototype.com=function(t){return this.comment(t)},t.prototype.ins=function(t,e){return this.instruction(t,e)},t.prototype.doc=function(){return this.document()},t.prototype.dec=function(t,e,r){return this.declaration(t,e,r)},t.prototype.e=function(t,e,r){return this.element(t,e,r)},t.prototype.n=function(t,e,r){return this.node(t,e,r)},t.prototype.t=function(t){return this.text(t)},t.prototype.d=function(t){return this.cdata(t)},t.prototype.c=function(t){return this.comment(t)},t.prototype.r=function(t){return this.raw(t)},t.prototype.i=function(t,e){return this.instruction(t,e)},t.prototype.u=function(){return this.up()},t.prototype.importXMLBuilder=function(t){return this.importDocument(t)},t.prototype.replaceChild=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.removeChild=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.appendChild=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.hasChildNodes=function(){return 0!==this.children.length},t.prototype.cloneNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isSupported=function(t,e){return!0},t.prototype.hasAttributes=function(){return 0!==this.attribs.length},t.prototype.compareDocumentPosition=function(t){var r,n;return(r=this)===t?0:this.document()!==t.document()?(n=e.Disconnected|e.ImplementationSpecific,Math.random()<.5?n|=e.Preceding:n|=e.Following,n):r.isAncestor(t)?e.Contains|e.Preceding:r.isDescendant(t)?e.Contains|e.Following:r.isPreceding(t)?e.Preceding:e.Following},t.prototype.isSameNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.lookupPrefix=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isDefaultNamespace=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.lookupNamespaceURI=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isEqualNode=function(t){var e,r,n;if(t.nodeType!==this.nodeType)return!1;if(t.children.length!==this.children.length)return!1;for(e=r=0,n=this.children.length-1;0<=n?r<=n:r>=n;e=0<=n?++r:--r)if(!this.children[e].isEqualNode(t.children[e]))return!1;return!0},t.prototype.getFeature=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.setUserData=function(t,e,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.getUserData=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.contains=function(t){return!!t&&(t===this||this.isDescendant(t))},t.prototype.isDescendant=function(t){var e,r,n,o;for(r=0,n=(o=this.children).length;r<n;r++){if(t===(e=o[r]))return!0;if(e.isDescendant(t))return!0}return!1},t.prototype.isAncestor=function(t){return t.isDescendant(this)},t.prototype.isPreceding=function(t){var e,r;return e=this.treePosition(t),r=this.treePosition(this),-1!==e&&-1!==r&&e<r},t.prototype.isFollowing=function(t){var e,r;return e=this.treePosition(t),r=this.treePosition(this),-1!==e&&-1!==r&&e>r},t.prototype.treePosition=function(t){var e,r;return r=0,e=!1,this.foreachTreeNode(this.document(),(function(n){if(r++,!e&&n===t)return e=!0})),e?r:-1},t.prototype.foreachTreeNode=function(t,e){var r,n,o,i,s;for(t||(t=this.document()),n=0,o=(i=t.children).length;n<o;n++){if(s=e(r=i[n]))return s;if(s=this.foreachTreeNode(r,e))return s}},t}()}).call(this)},82390:function(t){(function(){t.exports=function(){function t(t){this.nodes=t}return Object.defineProperty(t.prototype,"length",{get:function(){return this.nodes.length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.item=function(t){return this.nodes[t]||null},t}()}).call(this)},19181:function(t,e,r){(function(){var e,n,o={}.hasOwnProperty;e=r(39335),n=r(6488),t.exports=function(t){function r(t,n,o){if(r.__super__.constructor.call(this,t),null==n)throw new Error("Missing instruction target. "+this.debugInfo());this.type=e.ProcessingInstruction,this.target=this.stringify.insTarget(n),this.name=this.target,o&&(this.value=this.stringify.insValue(o))}return function(t,e){for(var r in e)o.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(r,t),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(t){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(t))},r.prototype.isEqualNode=function(t){return!!r.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&t.target===this.target},r}(n)}).call(this)},79406:function(t,e,r){(function(){var e,n,o={}.hasOwnProperty;e=r(39335),n=r(32026),t.exports=function(t){function r(t,n){if(r.__super__.constructor.call(this,t),null==n)throw new Error("Missing raw text. "+this.debugInfo());this.type=e.Raw,this.value=this.stringify.raw(n)}return function(t,e){for(var r in e)o.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(r,t),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(t){return this.options.writer.raw(this,this.options.writer.filterOptions(t))},r}(n)}).call(this)},81996:function(t,e,r){(function(){var e,n,o,i={}.hasOwnProperty;e=r(39335),o=r(60751),n=r(30594),t.exports=function(t){function r(t,e){this.stream=t,r.__super__.constructor.call(this,e)}return function(t,e){for(var r in e)i.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(r,t),r.prototype.endline=function(t,e,o){return t.isLastRootNode&&e.state===n.CloseTag?"":r.__super__.endline.call(this,t,e,o)},r.prototype.document=function(t,e){var r,n,o,i,s,a,l,c,u;for(n=o=0,s=(l=t.children).length;o<s;n=++o)(r=l[n]).isLastRootNode=n===t.children.length-1;for(e=this.filterOptions(e),u=[],i=0,a=(c=t.children).length;i<a;i++)r=c[i],u.push(this.writeChildNode(r,e,0));return u},r.prototype.attribute=function(t,e,n){return this.stream.write(r.__super__.attribute.call(this,t,e,n))},r.prototype.cdata=function(t,e,n){return this.stream.write(r.__super__.cdata.call(this,t,e,n))},r.prototype.comment=function(t,e,n){return this.stream.write(r.__super__.comment.call(this,t,e,n))},r.prototype.declaration=function(t,e,n){return this.stream.write(r.__super__.declaration.call(this,t,e,n))},r.prototype.docType=function(t,e,r){var o,i,s,a;if(r||(r=0),this.openNode(t,e,r),e.state=n.OpenTag,this.stream.write(this.indent(t,e,r)),this.stream.write("<!DOCTYPE "+t.root().name),t.pubID&&t.sysID?this.stream.write(' PUBLIC "'+t.pubID+'" "'+t.sysID+'"'):t.sysID&&this.stream.write(' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(t,e,r)),e.state=n.InsideTag,i=0,s=(a=t.children).length;i<s;i++)o=a[i],this.writeChildNode(o,e,r+1);e.state=n.CloseTag,this.stream.write("]")}return e.state=n.CloseTag,this.stream.write(e.spaceBeforeSlash+">"),this.stream.write(this.endline(t,e,r)),e.state=n.None,this.closeNode(t,e,r)},r.prototype.element=function(t,r,o){var s,a,l,c,u,p,h,f,d;for(h in o||(o=0),this.openNode(t,r,o),r.state=n.OpenTag,this.stream.write(this.indent(t,r,o)+"<"+t.name),f=t.attribs)i.call(f,h)&&(s=f[h],this.attribute(s,r,o));if(c=0===(l=t.children.length)?null:t.children[0],0===l||t.children.every((function(t){return(t.type===e.Text||t.type===e.Raw)&&""===t.value})))r.allowEmpty?(this.stream.write(">"),r.state=n.CloseTag,this.stream.write("</"+t.name+">")):(r.state=n.CloseTag,this.stream.write(r.spaceBeforeSlash+"/>"));else if(!r.pretty||1!==l||c.type!==e.Text&&c.type!==e.Raw||null==c.value){for(this.stream.write(">"+this.endline(t,r,o)),r.state=n.InsideTag,u=0,p=(d=t.children).length;u<p;u++)a=d[u],this.writeChildNode(a,r,o+1);r.state=n.CloseTag,this.stream.write(this.indent(t,r,o)+"</"+t.name+">")}else this.stream.write(">"),r.state=n.InsideTag,r.suppressPrettyCount++,this.writeChildNode(c,r,o+1),r.suppressPrettyCount--,r.state=n.CloseTag,this.stream.write("</"+t.name+">");return this.stream.write(this.endline(t,r,o)),r.state=n.None,this.closeNode(t,r,o)},r.prototype.processingInstruction=function(t,e,n){return this.stream.write(r.__super__.processingInstruction.call(this,t,e,n))},r.prototype.raw=function(t,e,n){return this.stream.write(r.__super__.raw.call(this,t,e,n))},r.prototype.text=function(t,e,n){return this.stream.write(r.__super__.text.call(this,t,e,n))},r.prototype.dtdAttList=function(t,e,n){return this.stream.write(r.__super__.dtdAttList.call(this,t,e,n))},r.prototype.dtdElement=function(t,e,n){return this.stream.write(r.__super__.dtdElement.call(this,t,e,n))},r.prototype.dtdEntity=function(t,e,n){return this.stream.write(r.__super__.dtdEntity.call(this,t,e,n))},r.prototype.dtdNotation=function(t,e,n){return this.stream.write(r.__super__.dtdNotation.call(this,t,e,n))},r}(o)}).call(this)},26434:function(t,e,r){(function(){var e,n={}.hasOwnProperty;e=r(60751),t.exports=function(t){function e(t){e.__super__.constructor.call(this,t)}return function(t,e){for(var r in e)n.call(e,r)&&(t[r]=e[r]);function o(){this.constructor=t}o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype}(e,t),e.prototype.document=function(t,e){var r,n,o,i,s;for(e=this.filterOptions(e),i="",n=0,o=(s=t.children).length;n<o;n++)r=s[n],i+=this.writeChildNode(r,e,0);return e.pretty&&i.slice(-e.newline.length)===e.newline&&(i=i.slice(0,-e.newline.length)),i},e}(e)}).call(this)},95549:function(t){(function(){var e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty;t.exports=function(){function t(t){var n,o,i;for(n in this.assertLegalName=e(this.assertLegalName,this),this.assertLegalChar=e(this.assertLegalChar,this),t||(t={}),this.options=t,this.options.version||(this.options.version="1.0"),o=t.stringify||{})r.call(o,n)&&(i=o[n],this[n]=i)}return t.prototype.name=function(t){return this.options.noValidation?t:this.assertLegalName(""+t||"")},t.prototype.text=function(t){return this.options.noValidation?t:this.assertLegalChar(this.textEscape(""+t||""))},t.prototype.cdata=function(t){return this.options.noValidation?t:(t=(t=""+t||"").replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(t))},t.prototype.comment=function(t){if(this.options.noValidation)return t;if((t=""+t||"").match(/--/))throw new Error("Comment text cannot contain double-hypen: "+t);return this.assertLegalChar(t)},t.prototype.raw=function(t){return this.options.noValidation?t:""+t||""},t.prototype.attValue=function(t){return this.options.noValidation?t:this.assertLegalChar(this.attEscape(t=""+t||""))},t.prototype.insTarget=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.insValue=function(t){if(this.options.noValidation)return t;if((t=""+t||"").match(/\?>/))throw new Error("Invalid processing instruction value: "+t);return this.assertLegalChar(t)},t.prototype.xmlVersion=function(t){if(this.options.noValidation)return t;if(!(t=""+t||"").match(/1\.[0-9]+/))throw new Error("Invalid version number: "+t);return t},t.prototype.xmlEncoding=function(t){if(this.options.noValidation)return t;if(!(t=""+t||"").match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+t);return this.assertLegalChar(t)},t.prototype.xmlStandalone=function(t){return this.options.noValidation?t:t?"yes":"no"},t.prototype.dtdPubID=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdSysID=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdElementValue=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdAttType=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdAttDefault=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdEntityValue=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdNData=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.convertAttKey="@",t.prototype.convertPIKey="?",t.prototype.convertTextKey="#text",t.prototype.convertCDataKey="#cdata",t.prototype.convertCommentKey="#comment",t.prototype.convertRawKey="#raw",t.prototype.assertLegalChar=function(t){var e,r;if(this.options.noValidation)return t;if(e="","1.0"===this.options.version){if(e=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,r=t.match(e))throw new Error("Invalid character in string: "+t+" at index "+r.index)}else if("1.1"===this.options.version&&(e=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,r=t.match(e)))throw new Error("Invalid character in string: "+t+" at index "+r.index);return t},t.prototype.assertLegalName=function(t){var e;if(this.options.noValidation)return t;if(this.assertLegalChar(t),e=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!t.match(e))throw new Error("Invalid character in name");return t},t.prototype.textEscape=function(t){var e;return this.options.noValidation?t:(e=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},t.prototype.attEscape=function(t){var e;return this.options.noValidation?t:(e=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},t}()}).call(this)},43595:function(t,e,r){(function(){var e,n,o={}.hasOwnProperty;e=r(39335),n=r(6488),t.exports=function(t){function r(t,n){if(r.__super__.constructor.call(this,t),null==n)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=e.Text,this.value=this.stringify.text(n)}return function(t,e){for(var r in e)o.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(r,t),Object.defineProperty(r.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"wholeText",{get:function(){var t,e,r;for(r="",e=this.previousSibling;e;)r=e.data+r,e=e.previousSibling;for(r+=this.data,t=this.nextSibling;t;)r+=t.data,t=t.nextSibling;return r}}),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(t){return this.options.writer.text(this,this.options.writer.filterOptions(t))},r.prototype.splitText=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.replaceWholeText=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r}(n)}).call(this)},60751:function(t,e,r){(function(){var e,n,o,i={}.hasOwnProperty;o=r(78369).assign,e=r(39335),r(59077),r(86544),r(66170),r(62096),r(32161),r(79406),r(43595),r(19181),r(78833),r(51179),r(36347),r(99078),r(44777),n=r(30594),t.exports=function(){function t(t){var e,r,n;for(e in t||(t={}),this.options=t,r=t.writer||{})i.call(r,e)&&(n=r[e],this["_"+e]=this[e],this[e]=n)}return t.prototype.filterOptions=function(t){var e,r,i,s,a,l,c,u;return t||(t={}),t=o({},this.options,t),(e={writer:this}).pretty=t.pretty||!1,e.allowEmpty=t.allowEmpty||!1,e.indent=null!=(r=t.indent)?r:"  ",e.newline=null!=(i=t.newline)?i:"\n",e.offset=null!=(s=t.offset)?s:0,e.dontPrettyTextNodes=null!=(a=null!=(l=t.dontPrettyTextNodes)?l:t.dontprettytextnodes)?a:0,e.spaceBeforeSlash=null!=(c=null!=(u=t.spaceBeforeSlash)?u:t.spacebeforeslash)?c:"",!0===e.spaceBeforeSlash&&(e.spaceBeforeSlash=" "),e.suppressPrettyCount=0,e.user={},e.state=n.None,e},t.prototype.indent=function(t,e,r){var n;return!e.pretty||e.suppressPrettyCount?"":e.pretty&&(n=(r||0)+e.offset+1)>0?new Array(n).join(e.indent):""},t.prototype.endline=function(t,e,r){return!e.pretty||e.suppressPrettyCount?"":e.newline},t.prototype.attribute=function(t,e,r){var n;return this.openAttribute(t,e,r),n=" "+t.name+'="'+t.value+'"',this.closeAttribute(t,e,r),n},t.prototype.cdata=function(t,e,r){var o;return this.openNode(t,e,r),e.state=n.OpenTag,o=this.indent(t,e,r)+"<![CDATA[",e.state=n.InsideTag,o+=t.value,e.state=n.CloseTag,o+="]]>"+this.endline(t,e,r),e.state=n.None,this.closeNode(t,e,r),o},t.prototype.comment=function(t,e,r){var o;return this.openNode(t,e,r),e.state=n.OpenTag,o=this.indent(t,e,r)+"\x3c!-- ",e.state=n.InsideTag,o+=t.value,e.state=n.CloseTag,o+=" --\x3e"+this.endline(t,e,r),e.state=n.None,this.closeNode(t,e,r),o},t.prototype.declaration=function(t,e,r){var o;return this.openNode(t,e,r),e.state=n.OpenTag,o=this.indent(t,e,r)+"<?xml",e.state=n.InsideTag,o+=' version="'+t.version+'"',null!=t.encoding&&(o+=' encoding="'+t.encoding+'"'),null!=t.standalone&&(o+=' standalone="'+t.standalone+'"'),e.state=n.CloseTag,o+=e.spaceBeforeSlash+"?>",o+=this.endline(t,e,r),e.state=n.None,this.closeNode(t,e,r),o},t.prototype.docType=function(t,e,r){var o,i,s,a,l;if(r||(r=0),this.openNode(t,e,r),e.state=n.OpenTag,a=this.indent(t,e,r),a+="<!DOCTYPE "+t.root().name,t.pubID&&t.sysID?a+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(a+=' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(a+=" [",a+=this.endline(t,e,r),e.state=n.InsideTag,i=0,s=(l=t.children).length;i<s;i++)o=l[i],a+=this.writeChildNode(o,e,r+1);e.state=n.CloseTag,a+="]"}return e.state=n.CloseTag,a+=e.spaceBeforeSlash+">",a+=this.endline(t,e,r),e.state=n.None,this.closeNode(t,e,r),a},t.prototype.element=function(t,r,o){var s,a,l,c,u,p,h,f,d,y,m,g,v,b;for(d in o||(o=0),y=!1,m="",this.openNode(t,r,o),r.state=n.OpenTag,m+=this.indent(t,r,o)+"<"+t.name,g=t.attribs)i.call(g,d)&&(s=g[d],m+=this.attribute(s,r,o));if(c=0===(l=t.children.length)?null:t.children[0],0===l||t.children.every((function(t){return(t.type===e.Text||t.type===e.Raw)&&""===t.value})))r.allowEmpty?(m+=">",r.state=n.CloseTag,m+="</"+t.name+">"+this.endline(t,r,o)):(r.state=n.CloseTag,m+=r.spaceBeforeSlash+"/>"+this.endline(t,r,o));else if(!r.pretty||1!==l||c.type!==e.Text&&c.type!==e.Raw||null==c.value){if(r.dontPrettyTextNodes)for(u=0,h=(v=t.children).length;u<h;u++)if(((a=v[u]).type===e.Text||a.type===e.Raw)&&null!=a.value){r.suppressPrettyCount++,y=!0;break}for(m+=">"+this.endline(t,r,o),r.state=n.InsideTag,p=0,f=(b=t.children).length;p<f;p++)a=b[p],m+=this.writeChildNode(a,r,o+1);r.state=n.CloseTag,m+=this.indent(t,r,o)+"</"+t.name+">",y&&r.suppressPrettyCount--,m+=this.endline(t,r,o),r.state=n.None}else m+=">",r.state=n.InsideTag,r.suppressPrettyCount++,y=!0,m+=this.writeChildNode(c,r,o+1),r.suppressPrettyCount--,y=!1,r.state=n.CloseTag,m+="</"+t.name+">"+this.endline(t,r,o);return this.closeNode(t,r,o),m},t.prototype.writeChildNode=function(t,r,n){switch(t.type){case e.CData:return this.cdata(t,r,n);case e.Comment:return this.comment(t,r,n);case e.Element:return this.element(t,r,n);case e.Raw:return this.raw(t,r,n);case e.Text:return this.text(t,r,n);case e.ProcessingInstruction:return this.processingInstruction(t,r,n);case e.Dummy:return"";case e.Declaration:return this.declaration(t,r,n);case e.DocType:return this.docType(t,r,n);case e.AttributeDeclaration:return this.dtdAttList(t,r,n);case e.ElementDeclaration:return this.dtdElement(t,r,n);case e.EntityDeclaration:return this.dtdEntity(t,r,n);case e.NotationDeclaration:return this.dtdNotation(t,r,n);default:throw new Error("Unknown XML node type: "+t.constructor.name)}},t.prototype.processingInstruction=function(t,e,r){var o;return this.openNode(t,e,r),e.state=n.OpenTag,o=this.indent(t,e,r)+"<?",e.state=n.InsideTag,o+=t.target,t.value&&(o+=" "+t.value),e.state=n.CloseTag,o+=e.spaceBeforeSlash+"?>",o+=this.endline(t,e,r),e.state=n.None,this.closeNode(t,e,r),o},t.prototype.raw=function(t,e,r){var o;return this.openNode(t,e,r),e.state=n.OpenTag,o=this.indent(t,e,r),e.state=n.InsideTag,o+=t.value,e.state=n.CloseTag,o+=this.endline(t,e,r),e.state=n.None,this.closeNode(t,e,r),o},t.prototype.text=function(t,e,r){var o;return this.openNode(t,e,r),e.state=n.OpenTag,o=this.indent(t,e,r),e.state=n.InsideTag,o+=t.value,e.state=n.CloseTag,o+=this.endline(t,e,r),e.state=n.None,this.closeNode(t,e,r),o},t.prototype.dtdAttList=function(t,e,r){var o;return this.openNode(t,e,r),e.state=n.OpenTag,o=this.indent(t,e,r)+"<!ATTLIST",e.state=n.InsideTag,o+=" "+t.elementName+" "+t.attributeName+" "+t.attributeType,"#DEFAULT"!==t.defaultValueType&&(o+=" "+t.defaultValueType),t.defaultValue&&(o+=' "'+t.defaultValue+'"'),e.state=n.CloseTag,o+=e.spaceBeforeSlash+">"+this.endline(t,e,r),e.state=n.None,this.closeNode(t,e,r),o},t.prototype.dtdElement=function(t,e,r){var o;return this.openNode(t,e,r),e.state=n.OpenTag,o=this.indent(t,e,r)+"<!ELEMENT",e.state=n.InsideTag,o+=" "+t.name+" "+t.value,e.state=n.CloseTag,o+=e.spaceBeforeSlash+">"+this.endline(t,e,r),e.state=n.None,this.closeNode(t,e,r),o},t.prototype.dtdEntity=function(t,e,r){var o;return this.openNode(t,e,r),e.state=n.OpenTag,o=this.indent(t,e,r)+"<!ENTITY",e.state=n.InsideTag,t.pe&&(o+=" %"),o+=" "+t.name,t.value?o+=' "'+t.value+'"':(t.pubID&&t.sysID?o+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(o+=' SYSTEM "'+t.sysID+'"'),t.nData&&(o+=" NDATA "+t.nData)),e.state=n.CloseTag,o+=e.spaceBeforeSlash+">"+this.endline(t,e,r),e.state=n.None,this.closeNode(t,e,r),o},t.prototype.dtdNotation=function(t,e,r){var o;return this.openNode(t,e,r),e.state=n.OpenTag,o=this.indent(t,e,r)+"<!NOTATION",e.state=n.InsideTag,o+=" "+t.name,t.pubID&&t.sysID?o+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.pubID?o+=' PUBLIC "'+t.pubID+'"':t.sysID&&(o+=' SYSTEM "'+t.sysID+'"'),e.state=n.CloseTag,o+=e.spaceBeforeSlash+">"+this.endline(t,e,r),e.state=n.None,this.closeNode(t,e,r),o},t.prototype.openNode=function(t,e,r){},t.prototype.closeNode=function(t,e,r){},t.prototype.openAttribute=function(t,e,r){},t.prototype.closeAttribute=function(t,e,r){},t}()}).call(this)},5532:function(t,e,r){(function(){var e,n,o,i,s,a,l,c,u,p;p=r(78369),c=p.assign,u=p.isFunction,o=r(91770),i=r(66934),s=r(79227),l=r(26434),a=r(81996),e=r(39335),n=r(30594),t.exports.create=function(t,e,r,n){var o,s;if(null==t)throw new Error("Root element needs a name.");return n=c({},e,r,n),s=(o=new i(n)).element(t),n.headless||(o.declaration(n),null==n.pubID&&null==n.sysID||o.dtd(n)),s},t.exports.begin=function(t,e,r){var n;return u(t)&&(e=(n=[t,e])[0],r=n[1],t={}),e?new s(t,e,r):new i(t)},t.exports.stringWriter=function(t){return new l(t)},t.exports.streamWriter=function(t,e){return new a(t,e)},t.exports.implementation=new o,t.exports.nodeType=e,t.exports.writerState=n}).call(this)}}]);