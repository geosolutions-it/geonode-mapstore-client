(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[8934],{8934:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>$});var i=o(93379),n=o.n(i),r=o(48342);n()(r.Z,{insert:"head",singleton:!1}),r.Z.locals;var s=o(27418),a=o.n(s),p=o(49179),c=o(58493),l=o(93409),h=o(23068),u=o(97016),d=o(29902),g=o(13002),f=o(9520),y=o(73381),m=o(40353),v=o(91358),w=o(21882),b=o(18672),O="accuracy",C="accuracyGeometry",_="altitude",k="altitudeAccuracy",P="heading",E="position",x="projection",j="speed",A="tracking",T="trackingOptions",L=function(t){function e(e){t.call(this,y.Z.ERROR),this.code=e.code,this.message=e.message}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(f.ZP);const D=function(t){function e(e){t.call(this);var o=e||{};this.position_=null,this.transform_=b.gD,this.watchId_=void 0,(0,g.oL)(this,(0,c.v_)(x),this.handleProjectionChanged_,this),(0,g.oL)(this,(0,c.v_)(A),this.handleTrackingChanged_,this),void 0!==o.projection&&this.setProjection(o.projection),void 0!==o.trackingOptions&&this.setTrackingOptions(o.trackingOptions),this.setTracking(void 0!==o.tracking&&o.tracking)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.setTracking(!1),t.prototype.disposeInternal.call(this)},e.prototype.handleProjectionChanged_=function(){var t=this.getProjection();t&&(this.transform_=(0,b.WO)((0,b.U2)("EPSG:4326"),t),this.position_&&this.set(E,this.transform_(this.position_)))},e.prototype.handleTrackingChanged_=function(){if(v.De){var t=this.getTracking();t&&void 0===this.watchId_?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):t||void 0===this.watchId_||(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}},e.prototype.positionChange_=function(t){var e=t.coords;this.set(O,e.accuracy),this.set(_,null===e.altitude?void 0:e.altitude),this.set(k,null===e.altitudeAccuracy?void 0:e.altitudeAccuracy),this.set(P,null===e.heading?void 0:(0,w.Yr)(e.heading)),this.position_?(this.position_[0]=e.longitude,this.position_[1]=e.latitude):this.position_=[e.longitude,e.latitude];var o=this.transform_(this.position_);this.set(E,o),this.set(j,null===e.speed?void 0:e.speed);var i=(0,m.iu)(this.position_,e.accuracy);i.applyTransform(this.transform_),this.set(C,i),this.changed()},e.prototype.positionError_=function(t){this.setTracking(!1),this.dispatchEvent(new L(t))},e.prototype.getAccuracy=function(){return this.get(O)},e.prototype.getAccuracyGeometry=function(){return this.get(C)||null},e.prototype.getAltitude=function(){return this.get(_)},e.prototype.getAltitudeAccuracy=function(){return this.get(k)},e.prototype.getHeading=function(){return this.get(P)},e.prototype.getPosition=function(){return this.get(E)},e.prototype.getProjection=function(){return this.get(x)},e.prototype.getSpeed=function(){return this.get(j)},e.prototype.getTracking=function(){return this.get(A)},e.prototype.getTrackingOptions=function(){return this.get(T)},e.prototype.setProjection=function(t){this.set(x,(0,b.U2)(t))},e.prototype.setTracking=function(t){this.set(A,t)},e.prototype.setTrackingOptions=function(t){this.set(T,t)},e}(c.ZP);var F=o(52043),S=o(69669),H=o(98090),Z=o(31219),I=o(98185),G=o(20767),R=o(9371),B=o(23493),M=o.n(B);function N(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,i)}return o}function U(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var W=function(){var t=document.createElement("div");t.setAttribute("class","ol-popup");var e=document.createElement("a");e.setAttribute("class","ol-popup-close-btn"),e.setAttribute("href","#close"),e.innerHTML="x";var o=document.createElement("div");o.setAttribute("class","ol-popup-cnt-wrapper");var i=document.createElement("div");i.setAttribute("class","ol-popup-cnt"),o.appendChild(i);var n=document.createElement("div");n.setAttribute("class","ol-popup-tip-wrapper");var r=document.createElement("div");return r.setAttribute("class","ol-popup-tip"),n.appendChild(r),t.appendChild(e),t.appendChild(o),t.appendChild(n),t}(),V=function(t,e){c.ZP.call(this,{state:"DISABLED"}),this.map=t;var o={drawCircle:!0,follow:!0,stopFollowingOnDrag:!1,remainActive:!0,locateStyle:this._getDefaultStyles(),metric:!0,onLocationError:this.onLocationError,keepCurrentZoomLevel:!1,showPopup:!0,strings:{metersUnit:"meters",feetUnit:"feet",popup:"You are within {distance} {unit} from this point"},locateOptions:{maximumAge:2e3,enableHighAccuracy:!1,timeout:1e4,maxZoom:18}};this.options=a()({},o,e||{}),this.geolocate=new D({projection:this.map.getView().getProjection(),trackingOptions:this.options.locateOptions}),this.updateHandler=this._updatePosFt.bind(this),this.geolocate.on("change:position",this.options.locateOptions.rateControl?M()(this.updateHandler,this.options.locateOptions.rateControl):this.updateHandler),this.popup=W,this.popup.hidden=!0,this.popCnt=W.getElementsByClassName("ol-popup-cnt")[0],this.overlay=new l.Z({element:this.popup,positioning:"top-center",stopEvent:!1}),this.layer=new d.Z({source:new u.Z({useSpatialIndex:!1})}),this.posFt=new h.Z({geometry:this.geolocate.getAccuracyGeometry(),name:"position",id:"_locate-pos"}),this.posFt.setStyle(this.options.locateStyle),this.layer.getSource().addFeature(this.posFt),this.clickHandler=this.mapClick.bind(this),this.stopHandler=this.stopFollow.bind(this),this.errorHandler=this.options.onLocationError.bind(this)};(0,p.XW)(V,c.ZP),V.prototype.start=function(){this.geolocate.on("error",this.errorHandler),this.follow=this.options.follow,this.geolocate.setTracking(!0),this.layer.setMap(this.map),this.map.addOverlay(this.overlay),this.options.showPopup&&(this.map.on("click",this.clickHandler),this.map.on("touch",this.clickHandler)),this.options.stopFollowingOnDrag&&this.map.on("pointerdrag",this.stopHandler),this.p?this._updatePosFt():this.set("state","LOCATING")},V.prototype.startFollow=function(){this.follow=!0,this.options.stopFollowingOnDrag&&this.map.on("pointerdrag",this.stopHandler),this.p&&this._updatePosFt()},V.prototype.stop=function(){this.geolocate.un("error",this.errorHandler),this.geolocate.setTracking(!1),this.popup.hide=!0,this.map.removeOverlay(this.overlay),this.layer.setMap(null),this.options.showPopup&&(this.map.un("click",this.clickHandler),this.map.un("touch",this.clickHandler)),this.options.stopFollowingOnDrag&&this.map.un("pointerdrag",this.stopHandler),this.set("state","DISABLED")},V.prototype.stopFollow=function(){this.follow=!1,this.map.un("pointerdrag",this.stopHandler),this.set("state","ENABLED")},V.prototype._updatePosFt=function(){var t=this.get("state"),e=this.follow?"FOLLOWING":"ENABLED";e!==t&&this.set("state",e);var o=this.geolocate.getPosition();this.p=o;var i=new F.Z([parseFloat(o[0]),parseFloat(o[1])]);if(this.options.drawCircle){var n=new S.Z([parseFloat(o[0]),parseFloat(o[1])],this.geolocate.getAccuracy());this.posFt.setGeometry(new H.default([i,n]))}else this.posFt.setGeometry(new H.default([i]));this.popup.hidden||this._updatePopUpCnt(),this.follow&&this.updateView(i),this.options.remainActive||this.geolocate.setTracking(!1)},V.prototype.updateView=function(t){this.follow&&(this.map.getView().setCenter(t.getCoordinates()),this.options.keepCurrentZoomLevel||this.map.getView().setZoom(this.options.locateOptions.maxZoom))},V.prototype._updatePopUpCnt=function(){var t,e;this.options.metric?(t=this.geolocate.getAccuracy(),e=this.options.strings.metersUnit):(t=Math.round(3.2808399*this.geolocate.getAccuracy()),e=this.options.strings.feetUnit);var o=this.options.strings.popup.replace("{distance}",t);this.popCnt.innerHTML=o.replace("{unit}",e),this.overlay.setPosition(this.posFt.getGeometry().getGeometries()[0].getCoordinates()),this.popup.hidden=!1},V.prototype.onLocationError=function(t){alert(t.message)},V.prototype.mapClick=function(t){var e=this.map.forEachFeatureAtPixel(t.pixel,(function(t){return t}));e&&"_locate-pos"===e.get("id")&&this.popup.hidden?this._updatePopUpCnt():this.popup.hidden||(W.hidden=!0)},V.prototype._getDefaultStyles=function(){return new Z.default({image:new R.default({radius:6,fill:new I.default({color:"rgba(42,147,238,0.7)"}),stroke:new G.default({color:"rgba(19,106,236,1)",width:2})}),fill:new I.default({color:"rgba(19,106,236,0.15)"}),stroke:new G.default({color:"rgba(19,106,236,1)",width:2})})},V.prototype.setStrings=function(t){this.options.strings=a()({},this.options.strings,t)},V.prototype.setTrackingOptions=function(t){this.geolocate&&(this.geolocate.setTrackingOptions(t),this.options.locateOptions=function(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?N(Object(o),!0).forEach((function(e){U(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):N(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}({},t))};const q=V;function Y(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function X(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,i)}return o}function z(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?X(Object(o),!0).forEach((function(e){K(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):X(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function K(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var J={follow:!0,remainActive:!0,metric:!0,stopFollowingOnDrag:!0,keepCurrentZoomLevel:!1,locateOptions:{maximumAge:2e3,enableHighAccuracy:!1,timeout:1e4,maxZoom:18}};function Q(t){return z(z(z({},J),t),{},{locateOptions:z(z({},J.locateOptions),t.locateOptions)})}const $=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,o;return e=t,(o=[{key:"start",value:function(t){var e=t.map,o=t.options,i=t.messages,n=t.status,r=t.onStateChange,s=t.onLocationError;this.locate=new q(e,Q(o)),this.locate.setStrings(i),this.locate.options.onLocationError=s,this.locate.on("propertychange",(function(t){r(t.target.get(t.key))})),this.configureLocate(n)}},{key:"update",value:function(t){var e=t.status,o=t.messages,i=t.options;this.configureLocate(e),this.locate.setStrings(o),this.locate.setTrackingOptions(Q(i).locateOptions)}},{key:"clear",value:function(){}},{key:"configureLocate",value:function(t){var e=this.locate.get("state");"ENABLED"===t&&"DISABLED"===e?this.locate.start():"FOLLOWING"===t&&"ENABLED"===e?this.locate.startFollow():"DISABLED"===t&&this.locate.stop()}}])&&Y(e.prototype,o),t}()},48342:(t,e,o)=>{"use strict";o.d(e,{Z:()=>r});var i=o(23645),n=o.n(i)()((function(t){return t[1]}));n.push([t.id,'.msgapi .ol-popup {\n    position: absolute;\n    text-align: center;\n    font: 12px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;\n    -ms-transform: translate(-50%,-100%); /* IE 9 */\n    -webkit-transform: translate(-50%,-100%); /* Safari */\n    transform: translate(-50%,-100%);\n}\n.msgapi a.ol-popup-close-btn {\n  position: absolute;\n  top: 0;\n  right: 0;\n  padding: 4px 4px 0 0;\n  text-align: center;\n  width: 18px;\n  height: 14px;\n  font: 16px/14px Tahoma, Verdana, sans-serif;\n  color: #c3c3c3;\n  text-decoration: none;\n  font-weight: bold;\n  background: transparent;\n}\n.msgapi .ol-popup-cnt-wrapper {\n  padding: 1px;\n  text-align: left;\n  border-radius: 12px;\n}\n.msgapi .ol-popup-cnt-wrapper, .msgapi .ol-popup-tip {\n  background: white;\n  box-shadow: 0 3px 14px rgba(0,0,0,0.4);\n}\n.msgapi .ol-popup-cnt {\n  margin: 13px 19px;\n  line-height: 1.4;\n   white-space: nowrap;\n\n}\n.msgapi .ol-popup-tip-wrapper {\n  margin: 0 auto;\n  width: 40px;\n  height: 20px;\n  position: relative;\n  overflow: hidden;\n\n}\n.msgapi .ol-popup-tip {\n  width: 17px;\n  height: 17px;\n  padding: 1px;\n  margin: -10px auto 0;\n  -webkit-transform: rotate(45deg);\n  -moz-transform: rotate(45deg);\n  -ms-transform: rotate(45deg);\n  -o-transform: rotate(45deg);\n  transform: rotate(45deg);\n}\n',""]);const r=n},23279:(t,e,o)=>{var i=o(13218),n=o(7771),r=o(14841),s=Math.max,a=Math.min;t.exports=function(t,e,o){var p,c,l,h,u,d,g=0,f=!1,y=!1,m=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function v(e){var o=p,i=c;return p=c=void 0,g=e,h=t.apply(i,o)}function w(t){return g=t,u=setTimeout(O,e),f?v(t):h}function b(t){var o=t-d;return void 0===d||o>=e||o<0||y&&t-g>=l}function O(){var t=n();if(b(t))return C(t);u=setTimeout(O,function(t){var o=e-(t-d);return y?a(o,l-(t-g)):o}(t))}function C(t){return u=void 0,m&&p?v(t):(p=c=void 0,h)}function _(){var t=n(),o=b(t);if(p=arguments,c=this,d=t,o){if(void 0===u)return w(d);if(y)return clearTimeout(u),u=setTimeout(O,e),v(d)}return void 0===u&&(u=setTimeout(O,e)),h}return e=r(e)||0,i(o)&&(f=!!o.leading,l=(y="maxWait"in o)?s(r(o.maxWait)||0,e):l,m="trailing"in o?!!o.trailing:m),_.cancel=function(){void 0!==u&&clearTimeout(u),g=0,p=d=c=u=void 0},_.flush=function(){return void 0===u?h:C(n())},_}},7771:(t,e,o)=>{var i=o(55639);t.exports=function(){return i.Date.now()}},23493:(t,e,o)=>{var i=o(23279),n=o(13218);t.exports=function(t,e,o){var r=!0,s=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return n(o)&&(r="leading"in o?!!o.leading:r,s="trailing"in o?!!o.trailing:s),i(t,e,{leading:r,maxWait:e,trailing:s})}},69669:(t,e,o)=>{"use strict";o.d(e,{Z:()=>p});var i=o(21915),n=o(28795),r=o(32538),s=o(38667),a=function(t){function e(e,o,i){if(t.call(this),void 0!==i&&void 0===o)this.setFlatCoordinates(i,e);else{var n=o||0;this.setCenterAndRadius(e,n,i)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),void 0,this.layout)},e.prototype.closestPointXY=function(t,e,o,i){var n=this.flatCoordinates,r=t-n[0],s=e-n[1],a=r*r+s*s;if(a<i){if(0===a)for(var p=0;p<this.stride;++p)o[p]=n[p];else{var c=this.getRadius()/Math.sqrt(a);o[0]=n[0]+c*r,o[1]=n[1]+c*s;for(var l=2;l<this.stride;++l)o[l]=n[l]}return o.length=this.stride,a}return i},e.prototype.containsXY=function(t,e){var o=this.flatCoordinates,i=t-o[0],n=e-o[1];return i*i+n*n<=this.getRadiusSquared_()},e.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.computeExtent=function(t){var e=this.flatCoordinates,o=e[this.stride]-e[0];return(0,i.T9)(e[0]-o,e[1]-o,e[0]+o,e[1]+o,t)},e.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},e.prototype.getRadiusSquared_=function(){var t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e},e.prototype.getType=function(){return n.Z.CIRCLE},e.prototype.intersectsExtent=function(t){var e=this.getExtent();if((0,i.kK)(t,e)){var o=this.getCenter();return t[0]<=o[0]&&t[2]>=o[0]||t[1]<=o[1]&&t[3]>=o[1]||(0,i.H6)(t,this.intersectsCoordinate,this)}return!1},e.prototype.setCenter=function(t){var e=this.stride,o=this.flatCoordinates[e]-this.flatCoordinates[0],i=t.slice();i[e]=i[0]+o;for(var n=1;n<e;++n)i[e+n]=t[n];this.setFlatCoordinates(this.layout,i),this.changed()},e.prototype.setCenterAndRadius=function(t,e,o){this.setLayout(o,t,0),this.flatCoordinates||(this.flatCoordinates=[]);var i=this.flatCoordinates,n=(0,s.IG)(i,0,t,this.stride);i[n++]=i[0]+e;for(var r=1,a=this.stride;r<a;++r)i[n++]=i[r];i.length=n,this.changed()},e.prototype.getCoordinates=function(){return null},e.prototype.setCoordinates=function(t,e){},e.prototype.setRadius=function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()},e}(r.ZP);a.prototype.transform;const p=a}}]);